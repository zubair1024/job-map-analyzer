{"version":3,"sources":["_components/PrivateRoute.js","utils.js","_components/TableComponent.js","_components/Map.js","_helpers/auth-header.js","_services/user.service.js","HomePage/HomePage.js","LoginPage/LoginPage.js","App/App.js","_helpers/fake-backend.js","index.js"],"names":["PrivateRoute","Component","component","rest","render","props","localStorage","getItem","to","pathname","state","from","location","dayjs","extend","utc","timezone","customParseFormat","isNumber","value","isNaN","parseFloat","isFinite","dayjsUtil","TableComponent","loadingDownloadLink","downloadLink","downloadLeadNumber","downloadData","dataRows","this","data","rows","tableHeaders","tableBody","map","row","idx","key","type","_id","onChange","handleShow","bind","name","className","onClick","handleEdit","handleDelete","handleDownload","style","float","filename","target","loadingComponent","width","e","a","setState","find","item","toString","layer","polygonCoords","getLatLngs","lat","lng","getLeads","leads","length","alert","Promise","resolve","reject","then","default","validatedData","filter","classification","classifyPoint","catch","err","url","Map","newPolygon","editPolygonDetails","tableData","columns","currentPolygonsInView","currentPolygonLabels","id","editPolygon","createNewPolygon","marginTop","for","aria-describedby","placeholder","submitNewPolygon","cancelNewPolygon","submitEditedPolygon","cancelEditedPolygon","run","isSelected","checked","selectedData","renderSelectedPolygon","removeAllPolygonsFromMap","enablePolygonEditControl","editableLayers","addLayer","window","confirm","deleteGroup","console","error","polygon","addPolygonAndLabelToMap","removePolygonAndLabelFromMap","_parentId","addTo","mapElement","label","L","Label","setContent","setLatLng","getBounds","getCenter","bindLabel","showLabel","prevState","removeLayer","forEach","saveGroup","addNewPolygon","resetForm","disablePolygonEditControl","Error","log","updateGroup","addEditedPolygon","GeoJSON","geometryToLayer","geoJSON","Object","assign","onLoad","addControls","getGroups","groups","populateGroups","axios","get","res","polygonDetails","toGeoJSON","geometry","group","post","put","delete","message","sanitizedData","StatusDate","sort","b","Date","FirstTimePolicyLiveDate","CreatedDate","format","sortedData","AppointmentDate","tz","diff","getE5Engineers","arrayContent","markers","marker","icon","markerIcon","bindPopup","markerPopupContent","push","circles","circle","getBoilerJobs","markerLayer","markerClusterGroup","getServiceJobs","addressPoints","p","heat","heatLayer","radius","minOpacity","content","tableContent","keys","k","iconUrl","iconSize","iconAnchor","popupAnchor","removeE5Engineers","e5EngineerCircle","e5EngineerMarkers","e5Engineer","serviceJob","clusters","serviceJobCluster","lead","leadCluster","boilerJob","boilerJobCluster","serviceJobsHeatMap","leadsHeatMap","boilerJobsHeatMap","control","custom","position","classes","events","click","srcElement","renderLeads","removeLeads","renderLeadsHeatMap","removeLeadsHeatMap","renderE5Engineers","renderE5EngineerCircles","removeE5EngineerCircles","renderServiceJobs","removeServiceJobs","renderServiceJobsHeatMap","removeServiceJobsHeatMap","renderBoilerJobs","removeBoilerJobs","renderBoilerJobsHeatMap","removeBoilerJobsHeatMap","showSideBar","hideSideBar","FeatureGroup","drawPluginOptions","draw","allowIntersection","drawError","color","shapeOptions","polyline","rectangle","edit","featureGroup","remove","drawControl","Control","Draw","on","layers","eachLayer","addControl","removeControl","$","config","loading","loaded","areas","districts","sectors","geoJsonLayerOptions","shapeStyle","onEachFeature","feature","setStyle","fillColor","randomRange","properties","noHide","layerAreas","geoJson","layerDistricts","layerSectors","layerGoogle","tileLayer","maxZoom","subdomains","layerOSM","openStreetMap","attribution","zoom","max","tileMaps","RAZRMAPS","overlayMaps","Areas","Districts","Sectors","center","sidebar","closeButton","min","Math","floor","random","sidebarElement","collapsed","initEditableLayer","initDrawControls","onAdd","div","DomUtil","create","innerHTML","getJSON","files","addData","features","html","statusText","show","hide","authHeader","user","JSON","parse","authdata","userService","login","username","password","requestOptions","method","headers","body","stringify","fetch","handleResponse","btoa","setItem","logout","getAll","removeItem","response","text","ok","status","reload","HomePage","users","React","LoginPage","submitted","handleChange","handleSubmit","preventDefault","returnUrl","history","onSubmit","disabled","src","App","exact","path","firstName","lastName","realFetch","opts","setTimeout","endsWith","params","filteredUsers","responseJson","Authorization","configureFakeBackend","document","getElementById"],"mappings":"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","file":"static/js/main.6370b453.chunk.js","sourcesContent":["import React from 'react';\nimport { Route, Redirect } from 'react-router-dom';\n\nexport const PrivateRoute = ({ component: Component, ...rest }) => (\n    <Route {...rest} render={props => (\n        localStorage.getItem('user')\n            ? <Component {...props} />\n            : <Redirect to={{ pathname: '/login', state: { from: props.location } }} />\n    )} />\n)","import dayjs from 'dayjs';\nimport utc from 'dayjs/plugin/utc';\nimport timezone from 'dayjs/plugin/timezone';\nimport customParseFormat from 'dayjs/plugin/customParseFormat';\n\ndayjs.extend(utc);\ndayjs.extend(timezone);\ndayjs.extend(customParseFormat);\n\nexport const isNumber = (value) => {\n  return !isNaN(parseFloat(value)) && isFinite(value);\n};\n\nexport const dayjsUtil = dayjs;\n","import React, { Component } from \"react\";\r\n\r\nimport { CSVLink } from \"react-csv\";\r\n\r\nimport classifyPoint from \"robust-point-in-polygon\";\r\n\r\nclass TableComponent extends Component {\r\n  state = {\r\n    loadingDownloadLink: false,\r\n    downloadLink: false,\r\n    downloadLeadNumber: null,\r\n    downloadData: []\r\n  };\r\n  render() {\r\n    const dataRows = this.props.data.rows;\r\n\r\n    const tableHeaders = (\r\n      <thead>\r\n        <tr>\r\n          <th>Show</th>\r\n          <th>Name</th>\r\n          <th>Edit</th>\r\n          <th>Delete</th>\r\n          <th>Download Leads</th>\r\n        </tr>\r\n      </thead>\r\n    );\r\n\r\n    const tableBody = dataRows.map((row, idx) => {\r\n      return (\r\n        <tr key={idx}>\r\n          <td key={`show${idx}`}>\r\n            <input\r\n              type=\"checkbox\"\r\n              value={row._id}\r\n              onChange={this.handleShow.bind(this)}\r\n            />\r\n          </td>\r\n          <td key={`column${{ idx }}`}>{row.name}</td>\r\n          <td key={`edit${idx}`}>\r\n            <button\r\n              className=\"btn btn-dark\"\r\n              value={row._id}\r\n              onClick={this.handleEdit.bind(this)}\r\n            >\r\n              Edit\r\n            </button>\r\n          </td>\r\n          <td key={`delete${idx}`}>\r\n            <button\r\n              className=\"btn btn-dark\"\r\n              value={row._id}\r\n              onClick={this.handleDelete.bind(this)}\r\n            >\r\n              Delete\r\n            </button>\r\n          </td>\r\n          <td key={`download${idx}`}>\r\n            <button\r\n              className=\"btn btn-dark\"\r\n              value={row._id}\r\n              onClick={this.handleDownload.bind(this)}\r\n            >\r\n              Download\r\n            </button>\r\n          </td>\r\n        </tr>\r\n      );\r\n    });\r\n\r\n    const downloadLink = this.state.downloadLink && (\r\n      <div style={{ float: \"right\" }}>\r\n        <CSVLink\r\n          data={this.state.downloadData}\r\n          filename={\"my-file.csv\"}\r\n          className=\"btn btn-dark\"\r\n          target=\"_blank\"\r\n        >\r\n          Download {this.state.downloadLeadNumber} Leads\r\n        </CSVLink>\r\n      </div>\r\n    );\r\n\r\n    const loadingComponent = this.state.loadingDownloadLink && (\r\n      <div>\r\n        <h3>Loading...</h3>\r\n      </div>\r\n    );\r\n\r\n    // Decorate with Bootstrap CSS\r\n    return (\r\n      <div>\r\n        <table className=\"table table-bordered table-hover\" width=\"100%\">\r\n          {tableHeaders}\r\n          <tbody>{tableBody}</tbody>\r\n        </table>\r\n        {downloadLink}\r\n        {loadingComponent}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  handleShow(e) {\r\n    this.props.handleShow(e);\r\n  }\r\n  handleEdit(e) {\r\n    this.props.handleEdit(e);\r\n  }\r\n  handleDelete(e) {\r\n    this.props.handleDelete(e);\r\n  }\r\n  async handleDownload(e) {\r\n    try {\r\n      this.setState({\r\n        loadingDownloadLink: true,\r\n        downloadLink: false\r\n      });\r\n      const data = this.props.data.rows.find(item => {\r\n        return item._id.toString() === e.target.value.toString();\r\n      });\r\n      if (data && data.layer) {\r\n        const polygonCoords = data.layer.getLatLngs().map(item => {\r\n          return [item.lat, item.lng];\r\n        });\r\n        const leads = await this.getLeads(polygonCoords);\r\n        if (leads.length) {\r\n          this.setState({\r\n            downloadLeadNumber: leads.length,\r\n            loadingDownloadLink: false,\r\n            downloadData: leads,\r\n            downloadLink: true\r\n          });\r\n        } else {\r\n          this.setState({\r\n            downloadLeadNumber: null,\r\n            loadingDownloadLink: false,\r\n            downloadData: [],\r\n            downloadLink: false\r\n          });\r\n          alert(`There are no leads in the selected cluster!`);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      alert(err);\r\n      this.setState({\r\n        downloadLeadNumber: null,\r\n        loadingDownloadLink: false,\r\n        downloadData: [],\r\n        downloadLink: false\r\n      });\r\n    }\r\n  }\r\n\r\n  getLeads(polygonCoords) {\r\n    return new Promise((resolve, reject) => {\r\n      import(\"../rawdata/leads.json\")\r\n        .then(data => {\r\n          if (data && data.default) {\r\n            const validatedData = data.default.filter(item => {\r\n              if (item.lat && item.lng) {\r\n                const classification = classifyPoint(polygonCoords, [\r\n                  item.lat,\r\n                  item.lng\r\n                ]);\r\n                return classification === -1 || classification === 0;\r\n              } else {\r\n                return false;\r\n              }\r\n            });\r\n            resolve(validatedData);\r\n          } else {\r\n            resolve([]);\r\n          }\r\n        })\r\n        .catch(err => {\r\n          reject(err);\r\n        });\r\n    });\r\n  }\r\n}\r\n\r\nexport default TableComponent;\r\n","import React, { Component } from 'react';\nimport axios from 'axios';\nimport { dayjsUtil } from '../utils';\nimport './Map.css';\n\nimport TableComponent from './TableComponent';\nimport { isNumber } from '../utils';\n\n// const url = `http://localhost:4000/api/group`;\nconst url = `https://map247.razrlab.com/api/group`;\n\nclass Map extends Component {\n  state = {\n    newPolygon: false,\n    editPolygonDetails: {\n      name: '',\n      layer: null,\n    },\n    tableData: {\n      columns: ['name'],\n      rows: [],\n    },\n    currentPolygonsInView: [],\n    currentPolygonLabels: [],\n  };\n\n  render() {\n    return (\n      <div>\n        <div id='map'></div>\n        <div id='sidebar'>\n          {!this.state.newPolygon && !this.state.editPolygon && (\n            <div>\n              <h3>Groups</h3>\n              <TableComponent\n                data={this.state.tableData}\n                handleShow={this.handleShow.bind(this)}\n                handleEdit={this.handleEdit.bind(this)}\n                handleDelete={this.handleDelete.bind(this)}\n              />\n              <button\n                className='btn btn-primary'\n                onClick={() => {\n                  this.createNewPolygon();\n                }}\n              >\n                Create New\n              </button>\n            </div>\n          )}\n\n          {this.state.newPolygon && (\n            <div>\n              <div className='row' style={{ marginTop: '5vh' }}>\n                <div className='form-group'>\n                  <label for='exampleInputEmail1'>Group Name</label>\n                  <input\n                    type='text'\n                    className='form-control'\n                    id='exampleInputEmail1'\n                    aria-describedby='emailHelp'\n                    placeholder='Enter Name'\n                    value={this.state.editPolygonDetails.name}\n                    onChange={(e) => {\n                      this.setState({\n                        editPolygonDetails: {\n                          ...this.state.editPolygonDetails,\n                          name: e.target.value,\n                        },\n                      });\n                    }}\n                  ></input>\n                  <small id='emailHelp' className='form-text text-muted'>\n                    Please enter a unqiue group name.\n                  </small>\n                </div>\n                <button\n                  className='btn btn-dark'\n                  onClick={() => {\n                    this.submitNewPolygon();\n                  }}\n                >\n                  Save\n                </button>{' '}\n                <button\n                  className='btn btn-danger'\n                  onClick={() => {\n                    this.cancelNewPolygon();\n                  }}\n                >\n                  Cancel\n                </button>\n              </div>\n            </div>\n          )}\n\n          {this.state.editPolygon && (\n            <div>\n              <div className='row' style={{ marginTop: '5vh' }}>\n                <div className='form-group'>\n                  <label for='exampleInputEmail1'>Group Name</label>\n                  <input\n                    type='text'\n                    className='form-control'\n                    id='exampleInputEmail1'\n                    aria-describedby='emailHelp'\n                    placeholder='Enter Name'\n                    value={this.state.editPolygonDetails.name}\n                    onChange={(e) => {\n                      this.setState({\n                        editPolygonDetails: {\n                          ...this.state.editPolygonDetails,\n                          name: e.target.value,\n                        },\n                      });\n                    }}\n                  ></input>\n                  <small id='emailHelp' className='form-text text-muted'>\n                    Please enter a unqiue group name.\n                  </small>\n                </div>\n                <button\n                  className='btn btn-dark'\n                  onClick={() => {\n                    this.submitEditedPolygon();\n                  }}\n                >\n                  Save\n                </button>{' '}\n                <button\n                  className='btn btn-danger'\n                  onClick={() => {\n                    this.cancelEditedPolygon();\n                  }}\n                >\n                  Cancel\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  componentDidMount() {\n    this.run();\n  }\n\n  handleShow(e) {\n    const _id = e.target.value;\n    const isSelected = e.target.checked;\n    const selectedData = this.state.tableData.rows.find((item) => {\n      return _id.toString() === item._id.toString();\n    });\n    if (selectedData && selectedData.layer)\n      this.renderSelectedPolygon(selectedData, isSelected);\n  }\n\n  async handleEdit(e) {\n    // debugger;\n    const _id = e.target.value;\n    const isSelected = true;\n    const selectedData = this.state.tableData.rows.find((item) => {\n      return _id.toString() === item._id.toString();\n    });\n    if (selectedData && selectedData.layer) {\n      await this.removeAllPolygonsFromMap();\n      await this.renderSelectedPolygon(selectedData, isSelected);\n      //enable controls and add poly to editable layer\n      this.enablePolygonEditControl();\n      this.editableLayers.addLayer(selectedData.layer);\n      this.setState({\n        editPolygon: true,\n        editPolygonDetails: {\n          _id: _id,\n          name: selectedData.name,\n          layer: selectedData.layer,\n        },\n      });\n    }\n  }\n\n  async handleDelete(e) {\n    const _id = e.target.value;\n    const confirmed = window.confirm(`Are you sure you want to delete?`);\n    if (confirmed) {\n      try {\n        //deselect the layer\n        const isSelected = false;\n\n        const selectedData = this.state.tableData.rows.find((item) => {\n          return _id.toString() === item._id.toString();\n        });\n        if (selectedData && selectedData.layer) {\n          this.renderSelectedPolygon(selectedData, isSelected);\n        }\n\n        const deletedGroup = await this.deleteGroup(selectedData);\n\n        if (deletedGroup) {\n          const rows = this.state.tableData.rows.filter((item) => {\n            return item._id && _id && item._id.toString() !== _id.toString();\n          });\n          this.setState({\n            tableData: {\n              ...this.state.tableData,\n              rows: rows,\n            },\n          });\n        }\n      } catch (err) {\n        console.error(err);\n        alert('An error occurred while deleting...');\n      }\n    }\n  }\n\n  async renderSelectedPolygon(data, isSelected) {\n    if (data.layer) {\n      const polygon = data.layer;\n      if (isSelected) {\n        await this.addPolygonAndLabelToMap(data, polygon);\n      } else {\n        await this.removePolygonAndLabelFromMap(data, polygon);\n      }\n    }\n  }\n\n  addPolygonAndLabelToMap(data, polygon) {\n    return new Promise((resolve) => {\n      //add to map\n      polygon._parentId = data._id;\n      polygon.addTo(this.mapElement);\n      //add label to map\n      const label = new window.L.Label();\n      label.setContent(data.name);\n      label.setLatLng(polygon.getBounds().getCenter());\n      label._parentId = data._id;\n      polygon.bindLabel(label);\n      this.mapElement.showLabel(label);\n      //save state\n      this.setState((prevState) => ({\n        currentPolygonsInView: [...prevState.currentPolygonsInView, polygon],\n        currentPolygonLabels: [...prevState.currentPolygonLabels, label],\n      }));\n      resolve();\n    });\n  }\n\n  removePolygonAndLabelFromMap(data, polygon) {\n    return new Promise((resolve) => {\n      const label = this.state.currentPolygonLabels.find((item) => {\n        return (\n          item._parentId &&\n          data._id &&\n          item._parentId.toString() === data._id.toString()\n        );\n      });\n\n      //remove them from the map\n      if (label) this.mapElement.removeLayer(label);\n      if (polygon) this.mapElement.removeLayer(polygon);\n\n      const currentPolygonsInView = this.state.currentPolygonsInView.filter(\n        (item) =>\n          item._parentId &&\n          label._parentId &&\n          item._parentId.toString() !== label._parentId.toString()\n      );\n      const currentPolygonLabels = this.state.currentPolygonLabels.filter(\n        (item) =>\n          item._parentId &&\n          label._parentId &&\n          item._parentId.toString() !== label._parentId.toString()\n      );\n\n      //save state\n      this.setState({\n        currentPolygonsInView: currentPolygonsInView,\n        currentPolygonLabels: currentPolygonLabels,\n      });\n      resolve();\n    });\n  }\n\n  removeAllPolygonsFromMap() {\n    return new Promise((resolve, reject) => {\n      const polygonLayers = this.state.currentPolygonsInView;\n      polygonLayers.forEach((item) => {\n        this.mapElement.removeLayer(item);\n      });\n      const polygonLabels = this.state.currentPolygonLabels;\n      polygonLabels.forEach((item) => {\n        this.mapElement.removeLayer(item);\n      });\n\n      //save new state\n      this.setState({\n        currentPolygonsInView: [],\n        currentPolygonLabels: [],\n      });\n      resolve();\n    });\n  }\n\n  async createNewPolygon() {\n    await this.removeAllPolygonsFromMap();\n    this.setState({\n      newPolygon: true,\n    });\n    this.enablePolygonEditControl();\n  }\n\n  async submitNewPolygon() {\n    try {\n      if (\n        this.state.editPolygonDetails.name !== '' &&\n        this.state.editPolygonDetails.layer\n      ) {\n        //name validation\n        const existingName = this.state.tableData.rows.find(\n          (item) => item.name === this.state.editPolygonDetails.name\n        );\n        if (existingName) {\n          alert(`Name already exists`);\n          return;\n        }\n\n        const newPolygon = await this.saveGroup(this.state.editPolygonDetails);\n\n        if (newPolygon) {\n          await this.addNewPolygon(newPolygon);\n          this.resetForm();\n          this.disablePolygonEditControl();\n          await this.removeAllPolygonsFromMap();\n        } else {\n          throw new Error(`new polygon not returned`);\n        }\n      } else {\n        alert(`Please input a valid name and shape`);\n      }\n    } catch (err) {\n      console.log(err);\n      alert(`An error occurred while editing`);\n    }\n  }\n\n  async submitEditedPolygon() {\n    try {\n      if (\n        this.state.editPolygonDetails.name !== '' &&\n        this.state.editPolygonDetails.layer\n      ) {\n        //name validation\n        const existingName = this.state.tableData.rows.find(\n          (item) =>\n            item.name === this.state.editPolygonDetails.name &&\n            item._id.toString() !== this.state.editPolygonDetails._id.toString()\n        );\n        if (existingName) {\n          alert(`Name already exists`);\n          return;\n        }\n\n        const newPolygon = await this.updateGroup(\n          this.state.editPolygonDetails\n        );\n\n        if (newPolygon) {\n          await this.addEditedPolygon(newPolygon);\n          this.resetForm();\n          this.disablePolygonEditControl();\n          await this.removeAllPolygonsFromMap();\n        } else {\n          throw new Error('new polygon not returned');\n        }\n      } else {\n        alert(`Please input a valid name and shape`);\n      }\n    } catch (err) {\n      console.error(err);\n      alert(`An error occurred while editing`);\n    }\n  }\n\n  addNewPolygon(data) {\n    return new Promise((resolve, reject) => {\n      this.setState({\n        tableData: {\n          rows: [\n            ...this.state.tableData.rows,\n            {\n              _id: data._id,\n              name: data.name,\n              layer: data.layer\n                ? data.layer\n                : window.L.GeoJSON.geometryToLayer(data.geoJSON),\n            },\n          ],\n        },\n      });\n      resolve();\n    });\n  }\n\n  addEditedPolygon(data) {\n    return new Promise((resolve, reject) => {\n      const rows = this.state.tableData.rows.map((item) => {\n        if (\n          this.state.editPolygonDetails._id.toString() === item._id.toString()\n        ) {\n          return Object.assign(item, {\n            name: this.state.editPolygonDetails.name,\n            layer: this.state.editPolygonDetails.layer,\n          });\n        } else {\n          return item;\n        }\n      });\n\n      this.setState({\n        tableData: {\n          rows: rows,\n        },\n      });\n      resolve();\n    });\n  }\n\n  cancelNewPolygon() {\n    this.resetForm();\n    this.removeAllPolygonsFromMap();\n    this.disablePolygonEditControl();\n  }\n\n  cancelEditedPolygon() {\n    this.resetForm();\n    this.removeAllPolygonsFromMap();\n    this.disablePolygonEditControl();\n  }\n\n  resetForm() {\n    this.setState({\n      newPolygon: false,\n      editPolygon: false,\n      editPolygonDetails: {\n        name: '',\n        layer: null,\n      },\n    });\n  }\n\n  async run() {\n    await this.onLoad();\n    this.addControls();\n    const groups = await this.getGroups();\n    if (groups && groups.length) {\n      this.populateGroups(groups);\n    }\n  }\n\n  populateGroups(groups) {\n    if (groups && groups.length) {\n      const data = groups\n        .filter((item) => {\n          return item.name && item.geoJSON && item._id;\n        })\n        .map((item) => {\n          item.layer = window.L.GeoJSON.geometryToLayer(item.geoJSON);\n          return item;\n        });\n      this.setState({\n        tableData: {\n          ...this.state.tableData,\n          rows: data,\n        },\n      });\n    }\n  }\n\n  getGroups() {\n    return new Promise((resolve, reject) => {\n      axios\n        .get(url)\n        .then((res) => {\n          if (res && res.data && res.data.data) {\n            resolve(res.data.data);\n          } else {\n            reject(new Error('There is no data'));\n          }\n          resolve();\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    });\n  }\n\n  saveGroup(polygonDetails) {\n    return new Promise((resolve, reject) => {\n      if (\n        polygonDetails &&\n        polygonDetails &&\n        polygonDetails.layer &&\n        polygonDetails.name &&\n        polygonDetails.layer.toGeoJSON() &&\n        polygonDetails.layer.toGeoJSON().geometry\n      ) {\n        let group = Object.assign({}, polygonDetails);\n        if (!group.geoJSON) {\n          group.geoJSON = group.layer.toGeoJSON().geometry;\n          delete group.layer;\n        }\n        axios\n          .post(url, group)\n          .then((res) => {\n            if (res && res.data && res.data.data) {\n              resolve(res.data.data);\n            } else {\n              reject(new Error('There is no data'));\n            }\n          })\n          .catch((err) => {\n            reject(err);\n          });\n      } else {\n        reject(new Error(`Insufficient parameters are being sent`));\n      }\n    });\n  }\n\n  updateGroup(polygonDetails) {\n    return new Promise((resolve, reject) => {\n      if (\n        polygonDetails &&\n        polygonDetails &&\n        polygonDetails.layer &&\n        polygonDetails.name &&\n        polygonDetails.layer.toGeoJSON() &&\n        polygonDetails.layer.toGeoJSON().geometry\n      ) {\n        let group = Object.assign({}, polygonDetails);\n        if (!group.geoJSON) {\n          group.geoJSON = group.layer.toGeoJSON().geometry;\n          delete group.layer;\n        }\n        axios\n          .put(url, group)\n          .then((res) => {\n            if (res && res.data && res.data.data) {\n              resolve(res.data.data);\n            } else {\n              reject(new Error('There is no data'));\n            }\n          })\n          .catch((err) => {\n            reject(err);\n          });\n      } else {\n        reject(new Error(`Insufficient parameters are being sent`));\n      }\n    });\n  }\n\n  deleteGroup(group) {\n    return new Promise((resolve, reject) => {\n      axios\n        .delete(url, {\n          data: {\n            _id: group._id,\n          },\n        })\n        .then((res) => {\n          if (res && res.data && res.data.message) {\n            resolve(res.data.message);\n          } else {\n            reject(new Error('There is no data'));\n          }\n          resolve();\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    });\n  }\n\n  getLeads() {\n    return new Promise((resolve, reject) => {\n      import('../rawdata/new/leads.json')\n        .then((data) => {\n          if (data && data.default) {\n            const validatedData = data.default.filter((item) => {\n              return (\n                isNumber(item.lat) &&\n                isNumber(item.lng) &&\n                item.StatusDate !== ''\n              );\n            });\n            //sort\n            const sortedData = validatedData.sort((a, b) => {\n              return new Date(a.StatusDate) - new Date(b.StatusDate);\n            });\n            //sanitize\n            const sanitizedData = sortedData.map((item) => {\n              return {\n                ...item,\n                StatusDate: dayjsUtil(item.StatusDate),\n                FirstTimePolicyLiveDate: dayjsUtil(\n                  item.FirstTimePolicyLiveDate\n                ),\n                CreatedDate: dayjsUtil(item.CreatedDate),\n              };\n            });\n            console.log(`render leads ${sanitizedData.length}`);\n            alert(\n              `render leads between ${sanitizedData[0].StatusDate.format(\n                'YYYY-MM-DD'\n              )} and ${sanitizedData[\n                sanitizedData.length - 1\n              ].StatusDate.format('YYYY-MM-DD')}`\n            );\n            resolve(sanitizedData);\n          } else {\n            resolve([]);\n          }\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    });\n  }\n\n  getGroupToRegions() {\n    return new Promise((resolve, reject) => {\n      import('../rawdata/postcodeWithRegions.json')\n        .then((data) => {\n          if (data && data.default) {\n            const validatedData = data.default.filter((item) => {\n              return item.lat && item.lng;\n            });\n            resolve(validatedData);\n          } else {\n            resolve([]);\n          }\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    });\n  }\n\n  getE5Engineers() {\n    return new Promise((resolve, reject) => {\n      import('../rawdata/new/engineers.json')\n        .then((data) => {\n          if (data && data.default) {\n            const validatedData = data.default.filter((item) => {\n              return isNumber(item.lat) && isNumber(item.lng);\n            });\n            resolve(validatedData);\n          } else {\n            resolve([]);\n          }\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    });\n  }\n\n  getBoilerJobs() {\n    return new Promise((resolve, reject) => {\n      import('../rawdata/new/boiler_jobs.json')\n        .then((data) => {\n          if (data && data.default) {\n            const validatedData = data.default.filter((item) => {\n              return (\n                isNumber(item.lat) &&\n                isNumber(item.lng) &&\n                item.AppointmentDate !== ''\n              );\n            });\n            const sanitizedData = validatedData.map((item) => {\n              return {\n                ...item,\n                AppointmentDate: dayjsUtil.tz(\n                  item.AppointmentDate,\n                  'DD/MM/YYYY',\n                  'Europe/London'\n                ),\n              };\n            });\n            const sortedData = sanitizedData.sort((a, b) => {\n              a.AppointmentDate.diff(b.AppointmentDate);\n            });\n            alert(\n              `render boiler jobs between ${sortedData[0].AppointmentDate.format(\n                'YYYY-MM-DD'\n              )} and ${sortedData[sortedData.length - 1].AppointmentDate.format(\n                'YYYY-MM-DD'\n              )}`\n            );\n            resolve(sortedData);\n          } else {\n            resolve([]);\n          }\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    });\n  }\n\n  getServiceJobs() {\n    return new Promise((resolve, reject) => {\n      import('../rawdata/new/service_jobs.json')\n        .then((data) => {\n          if (data && data.default) {\n            const validatedData = data.default.filter((item) => {\n              return (\n                isNumber(item.lat) &&\n                isNumber(item.lng) &&\n                item.AppointmentDate !== ''\n              );\n            });\n            const sanitizedData = validatedData.map((item) => {\n              return {\n                ...item,\n                AppointmentDate: dayjsUtil.tz(\n                  item.AppointmentDate,\n                  'DD/MM/YYYY',\n                  'Europe/London'\n                ),\n              };\n            });\n            const sortedData = sanitizedData.sort((a, b) => {\n              a.AppointmentDate.diff(b.AppointmentDate);\n            });\n            alert(\n              `render service jobs between ${sortedData[0].AppointmentDate.format(\n                'YYYY-MM-DD'\n              )} and ${sortedData[sortedData.length - 1].AppointmentDate.format(\n                'YYYY-MM-DD'\n              )}`\n            );\n            resolve(sortedData);\n          } else {\n            resolve([]);\n          }\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    });\n  }\n\n  async renderE5Engineers() {\n    const type = 'e5Engineer';\n    try {\n      const arrayContent = await this.getE5Engineers();\n      if (arrayContent && arrayContent.length) {\n        let markers = [];\n        arrayContent.forEach((item) => {\n          if (item.lat && item.lng) {\n            const marker = window.L.marker([item.lat, item.lng], {\n              icon: this.markerIcon(type),\n            }).addTo(this.mapElement);\n            marker.bindPopup(this.markerPopupContent(type, item));\n            markers.push(marker);\n          }\n        });\n        this.setState({\n          [type]: markers,\n        });\n      } else {\n        throw new Error(`No ${type} to be rendered`);\n      }\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  async renderE5EngineerCircles() {\n    const type = 'e5Engineer';\n    try {\n      const arrayContent = await this.getE5Engineers();\n      if (arrayContent && arrayContent.length) {\n        let circles = [];\n        arrayContent.forEach((item) => {\n          if (item.lat && item.lng) {\n            let circle = window.L.circle([item.lat, item.lng], 40233.6).addTo(\n              this.mapElement\n            );\n            circles.push(circle);\n          }\n        });\n        this.setState({\n          [`${type}Circle`]: circles,\n        });\n      } else {\n        throw new Error(`No ${type} to be rendered`);\n      }\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  async renderBoilerJobs() {\n    const type = 'boilerJob';\n    try {\n      const arrayContent = await this.getBoilerJobs();\n      if (arrayContent && arrayContent.length) {\n        let markerLayer = window.L.markerClusterGroup();\n        let markers = [];\n        arrayContent.forEach((item) => {\n          if (item.lat && item.lng) {\n            const marker = window.L.marker([item.lat, item.lng], {\n              icon: this.markerIcon(type),\n            });\n            marker.bindPopup(this.markerPopupContent(type, item));\n            markerLayer.addLayer(marker);\n            markers.push(marker);\n          }\n        });\n        markerLayer.addTo(this.mapElement);\n        this.setState({\n          [`${type}Cluster`]: markerLayer,\n          [type]: markers,\n        });\n      } else {\n        throw new Error(`No ${type} to be rendered`);\n      }\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  async renderServiceJobs() {\n    const type = 'serviceJob';\n    try {\n      const arrayContent = await this.getServiceJobs();\n      if (arrayContent && arrayContent.length) {\n        let markerLayer = window.L.markerClusterGroup();\n        let markers = [];\n        arrayContent.forEach((item) => {\n          if (item.lat && item.lng) {\n            const marker = window.L.marker([item.lat, item.lng], {\n              icon: this.markerIcon(type),\n            });\n            marker.bindPopup(this.markerPopupContent(type, item));\n            markerLayer.addLayer(marker);\n            markers.push(marker);\n          }\n        });\n        markerLayer.addTo(this.mapElement);\n        this.setState({\n          [`${type}Cluster`]: markerLayer,\n          [type]: markers,\n        });\n      } else {\n        throw new Error(`No ${type} to be rendered`);\n      }\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  async renderLeads() {\n    const type = 'lead';\n    try {\n      const arrayContent = await this.getLeads();\n      if (arrayContent && arrayContent.length) {\n        let markerLayer = window.L.markerClusterGroup();\n        let markers = [];\n        arrayContent.forEach((item) => {\n          if (item.lat && item.lng) {\n            const marker = window.L.marker([item.lat, item.lng], {\n              icon: this.markerIcon(type),\n            });\n            marker.bindPopup(this.markerPopupContent(type, item));\n            markerLayer.addLayer(marker);\n            markers.push(marker);\n          }\n        });\n        markerLayer.addTo(this.mapElement);\n        this.setState({\n          [`${type}Cluster`]: markerLayer,\n          [type]: markers,\n        });\n      } else {\n        throw new Error(`No ${type} to be rendered`);\n      }\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  async renderServiceJobsHeatMap() {\n    const type = 'serviceJob';\n    const arrayContent = await this.getServiceJobs();\n    const addressPoints = arrayContent.map(function (p) {\n      return [p.lat, p.lng, 0.5];\n    });\n    const heat = window.L.heatLayer(addressPoints, {\n      radius: 10,\n      minOpacity: 1,\n    }).addTo(this.mapElement);\n    this.setState({\n      [`${type}sHeatMap`]: heat,\n    });\n    try {\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  async renderLeadsHeatMap() {\n    const type = 'lead';\n    const arrayContent = await this.getLeads();\n    const addressPoints = arrayContent.map(function (p) {\n      return [p.lat, p.lng, 0.5];\n    });\n    const heat = window.L.heatLayer(addressPoints, {\n      radius: 10,\n      minOpacity: 1,\n    }).addTo(this.mapElement);\n    this.setState({\n      [`${type}sHeatMap`]: heat,\n    });\n    try {\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  async renderBoilerJobsHeatMap() {\n    const type = 'boilerJob';\n    const arrayContent = await this.getBoilerJobs();\n    const addressPoints = arrayContent.map(function (p) {\n      return [p.lat, p.lng, 0.5];\n    });\n    const heat = window.L.heatLayer(addressPoints, {\n      radius: 10,\n      minOpacity: 1,\n    }).addTo(this.mapElement);\n    this.setState({\n      [`${type}sHeatMap`]: heat,\n    });\n    try {\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  markerPopupContent(type, item) {\n    let content = '';\n    let tableContent = '';\n    Object.keys(item).forEach((k) => {\n      tableContent =\n        tableContent +\n        `\n      <tr>\n      <td class=\"popup-table-row\">\n      <td>${k}</td>\n      <td>${item[k]}</td>\n      </td>\n        </tr>\n        `;\n    });\n    if (tableContent) {\n      content = `\n      <table class=\"table table-dark\">\n      ${tableContent}\n      </table>\n      `;\n    }\n    return content;\n  }\n\n  markerIcon(type) {\n    //   \"https://res.cloudinary.com/razrlab/image/upload/c_scale,co_rgb:D12711,e_colorize:100,f_png/v1541359481/pin_t5dc4n.png\",\n    let icon = '';\n    switch (type) {\n      case 'e5Engineer':\n        icon = '/icons/person.png';\n        break;\n      case 'serviceJob':\n        icon = '/icons/service.png';\n        break;\n      case 'lead':\n        icon = '/icons/homes.png';\n        break;\n      case 'boilerJob':\n        icon = '/icons/breakdown.png';\n        break;\n      default:\n        //nothing\n        break;\n    }\n    const iconElement = window.L.icon({\n      iconUrl: icon,\n      iconSize: [25, 25],\n      iconAnchor: [12, 25],\n      popupAnchor: [3, -40],\n    });\n\n    return iconElement;\n  }\n\n  removeMarkers() {\n    return new Promise((resolve, reject) => {\n      this.removeE5Engineers();\n      resolve();\n    });\n  }\n\n  removeE5EngineerCircles() {\n    let circles = this.state.e5EngineerCircle;\n    if (circles && circles.length) {\n      circles.forEach((item) => {\n        this.mapElement.removeLayer(item);\n      });\n    }\n  }\n\n  removeE5Engineers() {\n    let e5EngineerMarkers = this.state.e5Engineer;\n    if (e5EngineerMarkers && e5EngineerMarkers.length) {\n      e5EngineerMarkers.forEach((item) => {\n        this.mapElement.removeLayer(item);\n      });\n    }\n  }\n\n  removeServiceJobs() {\n    let markers = this.state.serviceJob;\n    let clusters = this.state.serviceJobCluster;\n    if (markers && markers.length) {\n      markers.forEach((item) => {\n        this.mapElement.removeLayer(item);\n      });\n      clusters && this.mapElement.removeLayer(clusters);\n    }\n  }\n\n  removeLeads() {\n    let markers = this.state.lead;\n    let clusters = this.state.leadCluster;\n    if (markers && markers.length) {\n      markers.forEach((item) => {\n        this.mapElement.removeLayer(item);\n      });\n      clusters && this.mapElement.removeLayer(clusters);\n    }\n  }\n\n  removeBoilerJobs() {\n    let markers = this.state.boilerJob;\n    let clusters = this.state.boilerJobCluster;\n    if (markers && markers.length) {\n      markers.forEach((item) => {\n        this.mapElement.removeLayer(item);\n      });\n      clusters && this.mapElement.removeLayer(clusters);\n    }\n  }\n\n  removeServiceJobsHeatMap() {\n    const layer = this.state.serviceJobsHeatMap;\n    layer && this.mapElement.removeLayer(layer);\n  }\n\n  removeLeadsHeatMap() {\n    const layer = this.state.leadsHeatMap;\n    layer && this.mapElement.removeLayer(layer);\n  }\n\n  removeBoilerJobsHeatMap() {\n    const layer = this.state.boilerJobsHeatMap;\n    layer && this.mapElement.removeLayer(layer);\n  }\n  addControls() {\n    const L = window.L;\n    L.control\n      .custom({\n        position: 'bottomleft',\n        content: `\n        <div class=\"panel-body\">\n          <div class=\"checkbox\">\n            <label><input type=\"checkbox\" value=\"e5Engineers\">E5 Engineers</label>\n          </div>\n          <div class=\"checkbox\">\n            <label><input type=\"checkbox\" value=\"e5EngineerCircles\">E5 Engineers Boundaries</label>\n          </div>\n          <div class=\"checkbox\">\n          <label><input type=\"checkbox\" value=\"leadsHeatMap\">Leads Heat Map</label>\n          </div>\n          <div class=\"checkbox\">\n          <label><input type=\"checkbox\" value=\"serviceJobsHeatMap\">Service Jobs Heat Map</label>\n          </div>\n          <div class=\"checkbox\">\n          <label><input type=\"checkbox\" value=\"boilerJobsHeatMap\">Boiler Jobs Heat Map</label>\n          </div>\n          <div class=\"checkbox\">\n            <label><input type=\"checkbox\" value=\"leads\">Leads</label>\n          </div>\n          <div class=\"checkbox\">\n            <label><input type=\"checkbox\" value=\"serviceJobs\">Service Jobs</label>\n          </div>\n          <div class=\"checkbox\">\n            <label><input type=\"checkbox\" value=\"boilerJobs\">Boiler Jobs</label>\n          </div>\n          <hr />\n          <div class=\"checkbox\">\n            <label><input type=\"checkbox\" value=\"geofenceControls\">Polygon Controls</label>\n          </div>  \n        </div>\n        `,\n        classes: 'panel panel-default',\n        style: {},\n        events: {\n          click: (data) => {\n            if (data && data.srcElement && data.srcElement.type) {\n              switch (data.srcElement.value) {\n                case 'leads':\n                  data.srcElement.checked\n                    ? this.renderLeads()\n                    : this.removeLeads();\n                  break;\n                case 'leadsHeatMap':\n                  data.srcElement.checked\n                    ? this.renderLeadsHeatMap()\n                    : this.removeLeadsHeatMap();\n                  break;\n                case 'e5Engineers':\n                  data.srcElement.checked\n                    ? this.renderE5Engineers()\n                    : this.removeE5Engineers();\n                  break;\n                case 'e5EngineerCircles':\n                  data.srcElement.checked\n                    ? this.renderE5EngineerCircles()\n                    : this.removeE5EngineerCircles();\n                  break;\n                case 'serviceJobs':\n                  data.srcElement.checked\n                    ? this.renderServiceJobs()\n                    : this.removeServiceJobs();\n                  break;\n                case 'serviceJobsHeatMap':\n                  data.srcElement.checked\n                    ? this.renderServiceJobsHeatMap()\n                    : this.removeServiceJobsHeatMap();\n                  break;\n                case 'boilerJobs':\n                  data.srcElement.checked\n                    ? this.renderBoilerJobs()\n                    : this.removeBoilerJobs();\n                  break;\n                case 'boilerJobsHeatMap':\n                  data.srcElement.checked\n                    ? this.renderBoilerJobsHeatMap()\n                    : this.removeBoilerJobsHeatMap();\n                  break;\n                case 'geofenceControls':\n                  data.srcElement.checked\n                    ? this.showSideBar()\n                    : this.hideSideBar();\n                  break;\n                default:\n                  break;\n              }\n            }\n          },\n        },\n      })\n      .addTo(this.mapElement);\n  }\n\n  initEditableLayer() {\n    this.editableLayers = new window.L.FeatureGroup();\n    this.mapElement.addLayer(this.editableLayers);\n  }\n\n  initDrawControls() {\n    let drawPluginOptions = {\n      position: 'topright',\n      draw: {\n        polygon: {\n          allowIntersection: false, // Restricts shapes to simple polygons\n          drawError: {\n            color: '#e1e100', // Color the shape will turn when intersects\n            message: \"<strong>Oh snap!<strong> you can't draw that!\", // Message that will show when intersect\n          },\n          shapeOptions: {\n            color: '#97009c',\n          },\n        },\n        // disable toolbar item by setting it to false\n        polyline: false,\n        circle: false, // Turns off this drawing tool\n        rectangle: false,\n        marker: false,\n      },\n      edit: {\n        featureGroup: this.editableLayers, //REQUIRED!!\n        remove: false,\n      },\n    };\n    this.drawControl = new window.L.Control.Draw(drawPluginOptions);\n  }\n\n  enablePolygonEditControl() {\n    const map = this.mapElement;\n\n    map.on('draw:created', (e) => {\n      console.log('draw:created');\n      const layer = e.layer;\n\n      this.setState({\n        editPolygonDetails: {\n          ...this.state.editPolygonDetails,\n          layer: layer,\n        },\n        currentPolygonsInView: [layer],\n      });\n\n      this.editableLayers.addLayer(layer);\n    });\n\n    map.on('draw:edited', (e) => {\n      console.log('draw:edited');\n      const layers = e.layers;\n      layers.eachLayer((layer) => {\n        this.setState({\n          editPolygonDetails: {\n            ...this.state.editPolygonDetails,\n            layer: layer,\n          },\n          currentPolygonsInView: [layer],\n        });\n      });\n    });\n\n    map.addControl(this.drawControl);\n  }\n\n  disablePolygonEditControl() {\n    if (this.drawControl) {\n      this.mapElement.removeControl(this.drawControl);\n    }\n  }\n\n  onLoad() {\n    return new Promise((resolve, reject) => {\n      const L = window.L;\n      const $ = window.$;\n      const config = window.config;\n      const loading = L.control({ position: 'bottomright' }),\n        loaded = {\n          areas: false,\n          districts: false,\n          sectors: false,\n        },\n        geoJsonLayerOptions = {\n          style: config.shapeStyle,\n          onEachFeature: onEachFeature,\n        },\n        layerAreas = L.geoJson(null, geoJsonLayerOptions),\n        layerDistricts = L.geoJson(null, geoJsonLayerOptions),\n        layerSectors = L.geoJson(null, geoJsonLayerOptions),\n        layerGoogle = L.tileLayer(\n          'http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}?key=AIzaSyC0AJcO-U5RksjP02AQHxEuFlEW5xSKzp8',\n          {\n            maxZoom: 20,\n            subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],\n          }\n        ),\n        layerOSM = L.tileLayer(config.openStreetMap.url, {\n          // OpenStreetMap tile layer (default)\n          attribution: config.openStreetMap.attribution,\n          maxZoom: config.zoom.max,\n        }),\n        tileMaps = {\n          // Tile map layer switcher\n          'Google Maps': layerGoogle,\n          RAZRMAPS: layerOSM,\n        },\n        overlayMaps = {\n          // GeoJSON layer switcher\n          Areas: layerAreas,\n          Districts: layerDistricts,\n          Sectors: layerSectors,\n        },\n        map = L.map('map', {\n          // Setup map object\n          center: [53.21919, -1.86768],\n          zoom: 7,\n          layers: [layerOSM],\n        });\n\n      const sidebar = L.control.sidebar('sidebar', {\n        closeButton: true,\n        position: 'left',\n      });\n      map.addControl(sidebar);\n\n      //expose some elements\n      this.sidebarElement = sidebar;\n      this.mapElement = map;\n\n      // Add layers control\n      L.control.layers(tileMaps, overlayMaps, { collapsed: false }).addTo(map);\n\n      this.initEditableLayer();\n      this.initDrawControls();\n\n      // For each feature, set random fill colour and bind 'name' label\n      function onEachFeature(feature, layer) {\n        layer.setStyle({ fillColor: randomColor() });\n        layer.bindLabel(feature.properties.name, { noHide: true });\n      }\n\n      function randomRange(min, max) {\n        return Math.floor(Math.random() * (max - min)) + min;\n      }\n\n      function randomColor() {\n        return (\n          'rgb(' +\n          randomRange(0, 256) +\n          ',' +\n          randomRange(0, 256) +\n          ',' +\n          randomRange(0, 256) +\n          ')'\n        );\n      }\n\n      // Setup GeoJSON loading indicator and add to map\n      loading.onAdd = function () {\n        const div = L.DomUtil.create('div', 'control loader');\n\n        div.innerHTML = `\n              <div>\\\n                  Areas... <span id=\"loadAreas\">&#x21BB;</span><br>\n                  Districts... <span id=\"loadDistricts\">&#x21BB;</span><br>\n                  Sectors... <span id=\"loadSectors\">&#x21BB;</span>\n              </div>\n              `;\n\n        return div;\n      };\n      loading.addTo(map);\n\n      // Automatically set the GeoJSON layer depending on zoom level\n      // map.on(\"zoomend\", function() {\n      //   if (!(loaded.areas && loaded.districts && loaded.sectors)) {\n      //     return;\n      //   }\n\n      //   const zoom = map.getZoom();\n\n      //   if (\n      //     zoom >= config.zoom.areas &&\n      //     zoom < config.zoom.districts &&\n      //     !map.hasLayer(layerAreas)\n      //   ) {\n      //     map.removeLayer(layerDistricts);\n      //     map.removeLayer(layerSectors);\n      //     map.addLayer(layerAreas);\n      //   } else if (\n      //     zoom >= config.zoom.districts &&\n      //     zoom < config.zoom.sectors &&\n      //     !map.hasLayer(layerDistricts)\n      //   ) {\n      //     map.removeLayer(layerAreas);\n      //     map.removeLayer(layerSectors);\n      //     map.addLayer(layerDistricts);\n      //   } else if (zoom >= config.zoom.sectors && !map.hasLayer(layerSectors)) {\n      //     map.removeLayer(layerAreas);\n      //     map.removeLayer(layerDistricts);\n      //     map.addLayer(layerSectors);\n      //   }\n      // });\n\n      // Load postcode Areas GeoJSON file\n      $.getJSON(config.files.areas, function (data) {\n        // Add loaded GeoJSON data to layer\n        layerAreas.addData(data.features);\n\n        // Show Areas layer by default\n        map.addLayer(layerAreas);\n\n        loaded.areas = true;\n        $('#loadAreas').html('&#x2713;');\n      }).error(function (error) {\n        console.error(\n          \"Failed loading '\" + config.files.areas + \"'\",\n          'Error: ' + error.statusText\n        );\n\n        $('#loadAreas').html('&#x2717;');\n      });\n\n      // Load postcode Districts GeoJSON file\n      $.getJSON(config.files.districts, function (data) {\n        // Add loaded GeoJSON data to layer\n        layerDistricts.addData(data.features);\n\n        loaded.districts = true;\n        $('#loadDistricts').html('&#x2713;');\n      }).error(function (error) {\n        console.error(\n          \"Failed loading '\" + config.files.districts + \"'\",\n          'Error: ' + error.statusText\n        );\n\n        $('#loadDistricts').html('&#x2717;');\n      });\n\n      // Load postcode Sectors GeoJSON file\n      $.getJSON(config.files.sectors, function (data) {\n        // Add loaded GeoJSON data to layer\n        layerSectors.addData(data.features);\n\n        loaded.sectors = true;\n        $('#loadSectors').html('&#x2713;');\n      }).error(function (error) {\n        console.error(\n          \"Failed loading '\" + config.files.sectors + \"'\",\n          'Error: ' + error.statusText\n        );\n\n        $('#loadSectors').html('&#x2717;');\n      });\n      resolve();\n    });\n  }\n\n  showSideBar() {\n    this.sidebarElement.show();\n  }\n\n  hideSideBar() {\n    this.sidebarElement.hide();\n  }\n}\n\nexport { Map };\n","export function authHeader() {\n    // return authorization header with basic auth credentials\n    let user = JSON.parse(localStorage.getItem('user'));\n\n    if (user && user.authdata) {\n        return { 'Authorization': 'Basic ' + user.authdata };\n    } else {\n        return {};\n    }\n}","import { authHeader } from '../_helpers';\n\nexport const userService = {\n    login,\n    logout,\n    getAll\n};\n\nfunction login(username, password) {\n    const requestOptions = {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username, password })\n    };\n\n    return fetch(`/users/authenticate`, requestOptions)\n        .then(handleResponse)\n        .then(user => {\n            // login successful if there's a user in the response\n            if (user) {\n                // store user details and basic auth credentials in local storage \n                // to keep user logged in between page refreshes\n                user.authdata = window.btoa(username + ':' + password);\n                localStorage.setItem('user', JSON.stringify(user));\n            }\n\n            return user;\n        });\n}\n\nfunction logout() {\n    // remove user from local storage to log user out\n    localStorage.removeItem('user');\n}\n\nfunction getAll() {\n    const requestOptions = {\n        method: 'GET',\n        headers: authHeader()\n    };\n\n    return fetch(`/users`, requestOptions).then(handleResponse);\n}\n\nfunction handleResponse(response) {\n    return response.text().then(text => {\n        const data = text && JSON.parse(text);\n        if (!response.ok) {\n            if (response.status === 401) {\n                // auto logout if 401 response returned from api\n                logout();\n                window.location.reload(true);\n            }\n\n            const error = (data && data.message) || response.statusText;\n            return Promise.reject(error);\n        }\n\n        return data;\n    });\n}","import React from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport { userService } from \"../_services\";\n\nimport { Map } from \"../_components\";\n\nclass HomePage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      user: {},\n      users: []\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      user: JSON.parse(localStorage.getItem(\"user\")),\n      users: { loading: true }\n    });\n    userService.getAll().then(users => this.setState({ users }));\n  }\n\n  render() {\n    const { user, users } = this.state;\n    return <Map />;\n  }\n}\n\nexport { HomePage };\n","import React from \"react\";\n\nimport { userService } from \"../_services\";\n\nimport \"./LoginPage.css\";\n\nclass LoginPage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    userService.logout();\n\n    this.state = {\n      username: \"\",\n      password: \"\",\n      submitted: false,\n      loading: false,\n      error: \"\"\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  handleChange(e) {\n    const { name, value } = e.target;\n    this.setState({ [name]: value });\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n\n    this.setState({ submitted: true });\n    const { username, password, returnUrl } = this.state;\n\n    // stop here if form is invalid\n    if (!(username && password)) {\n      return;\n    }\n\n    this.setState({ loading: true });\n    userService.login(username, password).then(\n      user => {\n        const { from } = this.props.location.state || {\n          from: { pathname: \"/\" }\n        };\n        this.props.history.push(from);\n      },\n      error => this.setState({ error, loading: false })\n    );\n  }\n\n  render() {\n    const { username, password, submitted, loading, error } = this.state;\n\n    // return (\n    //   <div className=\"login-page\">\n    //     <div className=\"form\">\n    //       <form className=\"register-form\" onSubmit={this.handleSubmit}>\n    //         <input\n    //           type=\"text\"\n    //           className=\"form-control\"\n    //           name=\"username\"\n    //           value={username}\n    //           onChange={this.handleChange}\n    //         />\n    //         <input\n    //           type=\"password\"\n    //           className=\"form-control\"\n    //           name=\"password\"\n    //           value={password}\n    //           onChange={this.handleChange}\n    //         />\n    //       </form>\n    //       <form className=\"login-form\">\n    //         <input type=\"text\" placeholder=\"username\" />\n    //         <input type=\"password\" placeholder=\"password\" />\n    //         <div className=\"form-group\">\n    //           <button className=\"btn btn-primary\" disabled={loading}>\n    //             Login\n    //           </button>\n    //           {loading && (\n    //             <img src=\"data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==\" />\n    //           )}\n    //         </div>\n    //         {error && <div className={\"alert alert-danger\"}>{error}</div>}\n    //         <p className=\"message\">\n    //           This is a private page. If you're not supposed to be here, walk\n    //           away now!\n    //         </p>\n    //       </form>\n    //     </div>\n    //   </div>\n    // );\n\n    return (\n      <div className=\"login-page\">\n        <div className=\"form\">\n          <h2>Map Analyzer</h2>\n          <form name=\"form\" onSubmit={this.handleSubmit}>\n            <div\n              className={\n                \"form-group\" + (submitted && !username ? \" has-error\" : \"\")\n              }\n            >\n              <input\n                type=\"text\"\n                className=\"form-control\"\n                name=\"username\"\n                value={username}\n                onChange={this.handleChange}\n                placeholder=\"Username\"\n              />\n              {submitted && !username && (\n                <div className=\"help-block\">Username is required</div>\n              )}\n            </div>\n            <div\n              className={\n                \"form-group\" + (submitted && !password ? \" has-error\" : \"\")\n              }\n            >\n              <input\n                type=\"password\"\n                className=\"form-control\"\n                name=\"password\"\n                value={password}\n                onChange={this.handleChange}\n                placeholder=\"Password\"\n              />\n              {submitted && !password && (\n                <div className=\"help-block\">Password is required</div>\n              )}\n            </div>\n            <div className=\"form-group\">\n              <button className=\"btn btn-primary\" disabled={loading}>\n                Login\n              </button>\n              {loading && (\n                <img src=\"data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==\" />\n              )}\n            </div>\n            {error && <div className={\"alert alert-danger\"}>{error}</div>}\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport { LoginPage };\n","import React from \"react\";\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\n\nimport { PrivateRoute } from \"../_components\";\nimport { HomePage } from \"../HomePage\";\nimport { LoginPage } from \"../LoginPage\";\n\nclass App extends React.Component {\n  render() {\n    return (\n      // <div className=\"jumbotron\">\n      //     <div className=\"container\">\n      //         <div className=\"col-sm-8 col-sm-offset-2\">\n      <Router>\n        <div>\n          <PrivateRoute exact path=\"/\" component={HomePage} />\n          <Route path=\"/login\" component={LoginPage} />\n        </div>\n      </Router>\n      //         </div>\n      //     </div>\n      // </div>\n    );\n  }\n}\n\nexport { App };\n","export function configureFakeBackend() {\n    let users = [{ id: 1, username: 'vp', password: 'vptester', firstName: 'Test', lastName: 'User' }];\n    let realFetch = window.fetch;\n    window.fetch = function (url, opts) {\n        return new Promise((resolve, reject) => {\n            // wrap in timeout to simulate server api call\n            setTimeout(() => {\n\n                // authenticate\n                if (url.endsWith('/users/authenticate') && opts.method === 'POST') {\n                    // get parameters from post request\n                    let params = JSON.parse(opts.body);\n\n                    // find if any user matches login credentials\n                    let filteredUsers = users.filter(user => {\n                        return user.username === params.username && user.password === params.password;\n                    });\n\n                    if (filteredUsers.length) {\n                        // if login details are valid return user details\n                        let user = filteredUsers[0];\n                        let responseJson = {\n                            id: user.id,\n                            username: user.username,\n                            firstName: user.firstName,\n                            lastName: user.lastName\n                        };\n                        resolve({ ok: true, text: () => Promise.resolve(JSON.stringify(responseJson)) });\n                    } else {\n                        // else return error\n                        reject('Username or password is incorrect');\n                    }\n\n                    return;\n                }\n\n                // get users\n                if (url.endsWith('/users') && opts.method === 'GET') {\n                    // check for fake auth token in header and return users if valid, this security \n                    // is implemented server side in a real application\n                    if (opts.headers && opts.headers.Authorization === `Basic ${window.btoa('vp:vptester')}`) {\n                        resolve({ ok: true, text: () => Promise.resolve(JSON.stringify(users)) });\n                    } else {\n                        // return 401 not authorised if token is null or invalid\n                        resolve({ status: 401, text: () => Promise.resolve() });\n                    }\n\n                    return;\n                }\n\n                // pass through any requests not handled above\n                realFetch(url, opts).then(response => resolve(response));\n\n            }, 500);\n        });\n    }\n}","import React from 'react';\nimport { render } from 'react-dom';\n\nimport { App } from './App';\n\n// setup fake backend\nimport { configureFakeBackend } from './_helpers';\n\nconfigureFakeBackend();\nrender(<App />, document.getElementById('root'));\n"],"sourceRoot":""}