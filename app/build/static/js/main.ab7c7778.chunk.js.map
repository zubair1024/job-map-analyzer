{"version":3,"sources":["_components/PrivateRoute.js","_components/TableComponent.js","_components/Map.js","_helpers/auth-header.js","_services/user.service.js","HomePage/HomePage.js","LoginPage/LoginPage.js","App/App.js","_helpers/fake-backend.js","index.js"],"names":["PrivateRoute","Component","component","rest","render","props","localStorage","getItem","to","pathname","state","from","location","TableComponent","loadingDownloadLink","downloadLink","downloadLeadNumber","downloadData","dataRows","this","data","rows","tableHeaders","tableBody","map","row","idx","key","type","value","_id","onChange","handleShow","bind","name","className","onClick","handleEdit","handleDelete","handleDownload","style","float","filename","target","loadingComponent","width","e","setState","find","item","toString","layer","polygonCoords","getLatLngs","lat","lng","getLeads","leads","length","alert","Promise","resolve","reject","then","default","validatedData","filter","classification","classifyPoint","catch","err","url","Map","newPolygon","editPolygonDetails","tableData","columns","currentPolygonsInView","currentPolygonLabels","id","editPolygon","createNewPolygon","marginTop","for","aria-describedby","placeholder","sumbitNewPolygon","cancelNewPolygon","sumbitEditedPolygon","cancelEditedPolygon","run","isSelected","checked","selectedData","renderSelectedPolygon","removeAllPolygonsFromMap","enablePolygonEditControl","editableLayers","addLayer","window","confirm","console","error","polygon","addPolygonAndLabelToMap","removePolygonAndLabelFromMap","_parentId","addTo","mapElement","label","L","Label","setContent","setLatLng","getBounds","getCenter","bindLabel","showLabel","prevState","removeLayer","forEach","saveGroup","addNewPolygon","resetForm","disablePolygonEditControl","log","updateGroup","addEditedPolygon","Math","random","Object","assign","onLoad","addControls","getGroups","groups","populateGroups","geoJSON","GeoJSON","geometryToLayer","axios","get","res","Error","polygonDetails","toGeoJSON","geometry","group","post","message","put","delete","getE5Engineers","arrayContent","markers","marker","icon","markerIcon","bindPopup","markerPopupContent","push","circles","circle","getBoilerJobs","markerLayer","markerClusterGroup","getServiceJobs","addressPoints","p","heat","heatLayer","radius","minOpacity","content","tableContent","keys","k","iconUrl","iconSize","iconAnchor","popupAnchor","removeE5Engineers","e5EngineerCircle","e5EngineerMarkers","e5Engineer","serviceJob","clusters","serviceJobCluster","lead","leadCluster","boilerJob","boilerJobCluster","serviceJobsHeatMap","leadsHeatMap","boilerJobsHeatMap","control","custom","position","classes","events","click","srcElement","renderLeads","removeLeads","renderLeadsHeatMap","removeLeadsHeatMap","renderE5Engineers","renderE5EngineerCircles","removeE5EngineerCircles","renderServiceJobs","removeServiceJobs","renderServiceJobsHeatMap","removeServiceJobsHeatMap","renderBoilerJobs","removeBoilerJobs","renderBoilerJobsHeatMap","removeBoilerJobsHeatMap","showSideBar","hideSideBar","FeatureGroup","drawPluginOptions","draw","allowIntersection","drawError","color","shapeOptions","polyline","rectangle","edit","featureGroup","remove","drawControl","Control","Draw","on","layers","eachLayer","addControl","removeControl","$","config","loading","loaded","areas","districts","sectors","geoJsonLayerOptions","shapeStyle","onEachFeature","feature","setStyle","fillColor","randomRange","properties","noHide","layerAreas","geoJson","layerDistricts","layerSectors","layerGoogle","tileLayer","maxZoom","subdomains","layerOSM","openStreetMap","attribution","zoom","max","tileMaps","RAZRMAPS","overlayMaps","Areas","Districts","Sectors","center","sidebar","closeButton","min","floor","sidebarElement","collapsed","initEditableLayer","initDrawControls","onAdd","div","DomUtil","create","innerHTML","getJSON","files","addData","features","html","statusText","show","hide","authHeader","user","JSON","parse","authdata","userService","login","username","password","requestOptions","method","headers","body","stringify","fetch","handleResponse","btoa","setItem","logout","getAll","removeItem","response","text","ok","status","reload","HomePage","users","React","LoginPage","submitted","handleChange","handleSubmit","preventDefault","returnUrl","history","onSubmit","disabled","src","App","exact","path","firstName","lastName","realFetch","opts","setTimeout","endsWith","params","filteredUsers","responseJson","Authorization","configureFakeBackend","document","getElementById"],"mappings":"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","file":"static/js/main.ab7c7778.chunk.js","sourcesContent":["import React from 'react';\nimport { Route, Redirect } from 'react-router-dom';\n\nexport const PrivateRoute = ({ component: Component, ...rest }) => (\n    <Route {...rest} render={props => (\n        localStorage.getItem('user')\n            ? <Component {...props} />\n            : <Redirect to={{ pathname: '/login', state: { from: props.location } }} />\n    )} />\n)","import React, { Component } from \"react\";\r\n\r\nimport { CSVLink } from \"react-csv\";\r\n\r\nimport classifyPoint from \"robust-point-in-polygon\";\r\n\r\nclass TableComponent extends Component {\r\n  state = {\r\n    loadingDownloadLink: false,\r\n    downloadLink: false,\r\n    downloadLeadNumber: null,\r\n    downloadData: []\r\n  };\r\n  render() {\r\n    const dataRows = this.props.data.rows;\r\n\r\n    const tableHeaders = (\r\n      <thead>\r\n        <tr>\r\n          <th>Show</th>\r\n          <th>Name</th>\r\n          <th>Edit</th>\r\n          <th>Delete</th>\r\n          <th>Download Leads</th>\r\n        </tr>\r\n      </thead>\r\n    );\r\n\r\n    const tableBody = dataRows.map((row, idx) => {\r\n      return (\r\n        <tr key={idx}>\r\n          <td key={`show${idx}`}>\r\n            <input\r\n              type=\"checkbox\"\r\n              value={row._id}\r\n              onChange={this.handleShow.bind(this)}\r\n            />\r\n          </td>\r\n          <td key={`column${{ idx }}`}>{row.name}</td>\r\n          <td key={`edit${idx}`}>\r\n            <button\r\n              className=\"btn btn-dark\"\r\n              value={row._id}\r\n              onClick={this.handleEdit.bind(this)}\r\n            >\r\n              Edit\r\n            </button>\r\n          </td>\r\n          <td key={`delete${idx}`}>\r\n            <button\r\n              className=\"btn btn-dark\"\r\n              value={row._id}\r\n              onClick={this.handleDelete.bind(this)}\r\n            >\r\n              Delete\r\n            </button>\r\n          </td>\r\n          <td key={`download${idx}`}>\r\n            <button\r\n              className=\"btn btn-dark\"\r\n              value={row._id}\r\n              onClick={this.handleDownload.bind(this)}\r\n            >\r\n              Download\r\n            </button>\r\n          </td>\r\n        </tr>\r\n      );\r\n    });\r\n\r\n    const downloadLink = this.state.downloadLink && (\r\n      <div style={{ float: \"right\" }}>\r\n        <CSVLink\r\n          data={this.state.downloadData}\r\n          filename={\"my-file.csv\"}\r\n          className=\"btn btn-dark\"\r\n          target=\"_blank\"\r\n        >\r\n          Download {this.state.downloadLeadNumber} Leads\r\n        </CSVLink>\r\n      </div>\r\n    );\r\n\r\n    const loadingComponent = this.state.loadingDownloadLink && (\r\n      <div>\r\n        <h3>Loading...</h3>\r\n      </div>\r\n    );\r\n\r\n    // Decorate with Bootstrap CSS\r\n    return (\r\n      <div>\r\n        <table className=\"table table-bordered table-hover\" width=\"100%\">\r\n          {tableHeaders}\r\n          <tbody>{tableBody}</tbody>\r\n        </table>\r\n        {downloadLink}\r\n        {loadingComponent}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  handleShow(e) {\r\n    this.props.handleShow(e);\r\n  }\r\n  handleEdit(e) {\r\n    this.props.handleEdit(e);\r\n  }\r\n  handleDelete(e) {\r\n    this.props.handleDelete(e);\r\n  }\r\n  async handleDownload(e) {\r\n    try {\r\n      this.setState({\r\n        loadingDownloadLink: true,\r\n        downloadLink: false\r\n      });\r\n      const data = this.props.data.rows.find(item => {\r\n        return item._id.toString() === e.target.value.toString();\r\n      });\r\n      if (data && data.layer) {\r\n        const polygonCoords = data.layer.getLatLngs().map(item => {\r\n          return [item.lat, item.lng];\r\n        });\r\n        const leads = await this.getLeads(polygonCoords);\r\n        if (leads.length) {\r\n          this.setState({\r\n            downloadLeadNumber: leads.length,\r\n            loadingDownloadLink: false,\r\n            downloadData: leads,\r\n            downloadLink: true\r\n          });\r\n        } else {\r\n          this.setState({\r\n            downloadLeadNumber: null,\r\n            loadingDownloadLink: false,\r\n            downloadData: [],\r\n            downloadLink: false\r\n          });\r\n          alert(`There are no leads in the selected cluster!`);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      alert(err);\r\n      this.setState({\r\n        downloadLeadNumber: null,\r\n        loadingDownloadLink: false,\r\n        downloadData: [],\r\n        downloadLink: false\r\n      });\r\n    }\r\n  }\r\n\r\n  getLeads(polygonCoords) {\r\n    return new Promise((resolve, reject) => {\r\n      import(\"../rawdata/leads.json\")\r\n        .then(data => {\r\n          if (data && data.default) {\r\n            const validatedData = data.default.filter(item => {\r\n              if (item.lat && item.lng) {\r\n                const classification = classifyPoint(polygonCoords, [\r\n                  item.lat,\r\n                  item.lng\r\n                ]);\r\n                return classification === -1 || classification === 0;\r\n              } else {\r\n                return false;\r\n              }\r\n            });\r\n            resolve(validatedData);\r\n          } else {\r\n            resolve([]);\r\n          }\r\n        })\r\n        .catch(err => {\r\n          reject(err);\r\n        });\r\n    });\r\n  }\r\n}\r\n\r\nexport default TableComponent;\r\n","import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport \"./Map.css\";\n\nimport TableComponent from \"./TableComponent\";\n\n// const url = `http://localhost:4000/api/group`;\nconst url = `https://map247.razrlab.com/api/group`;\n\nclass Map extends Component {\n  state = {\n    newPolygon: false,\n    editPolygonDetails: {\n      name: \"\",\n      layer: null\n    },\n    tableData: {\n      columns: [\"name\"],\n      rows: []\n    },\n    currentPolygonsInView: [],\n    currentPolygonLabels: []\n  };\n\n  render() {\n    return (\n      <div>\n        <div id=\"map\"></div>\n        <div id=\"sidebar\">\n          {!this.state.newPolygon && !this.state.editPolygon && (\n            <div>\n              <h3>Groups</h3>\n              <TableComponent\n                data={this.state.tableData}\n                handleShow={this.handleShow.bind(this)}\n                handleEdit={this.handleEdit.bind(this)}\n                handleDelete={this.handleDelete.bind(this)}\n              />\n              <button\n                className=\"btn btn-primary\"\n                onClick={() => {\n                  this.createNewPolygon();\n                }}\n              >\n                Create New\n              </button>\n            </div>\n          )}\n\n          {this.state.newPolygon && (\n            <div>\n              <div className=\"row\" style={{ marginTop: \"5vh\" }}>\n                <div className=\"form-group\">\n                  <label for=\"exampleInputEmail1\">Group Name</label>\n                  <input\n                    type=\"text\"\n                    className=\"form-control\"\n                    id=\"exampleInputEmail1\"\n                    aria-describedby=\"emailHelp\"\n                    placeholder=\"Enter Name\"\n                    value={this.state.editPolygonDetails.name}\n                    onChange={e => {\n                      this.setState({\n                        editPolygonDetails: {\n                          ...this.state.editPolygonDetails,\n                          name: e.target.value\n                        }\n                      });\n                    }}\n                  ></input>\n                  <small id=\"emailHelp\" className=\"form-text text-muted\">\n                    Please enter a unqiue group name.\n                  </small>\n                </div>\n                <button\n                  className=\"btn btn-dark\"\n                  onClick={() => {\n                    this.sumbitNewPolygon();\n                  }}\n                >\n                  Save\n                </button>{\" \"}\n                <button\n                  className=\"btn btn-danger\"\n                  onClick={() => {\n                    this.cancelNewPolygon();\n                  }}\n                >\n                  Cancel\n                </button>\n              </div>\n            </div>\n          )}\n\n          {this.state.editPolygon && (\n            <div>\n              <div className=\"row\" style={{ marginTop: \"5vh\" }}>\n                <div className=\"form-group\">\n                  <label for=\"exampleInputEmail1\">Group Name</label>\n                  <input\n                    type=\"text\"\n                    className=\"form-control\"\n                    id=\"exampleInputEmail1\"\n                    aria-describedby=\"emailHelp\"\n                    placeholder=\"Enter Name\"\n                    value={this.state.editPolygonDetails.name}\n                    onChange={e => {\n                      this.setState({\n                        editPolygonDetails: {\n                          ...this.state.editPolygonDetails,\n                          name: e.target.value\n                        }\n                      });\n                    }}\n                  ></input>\n                  <small id=\"emailHelp\" className=\"form-text text-muted\">\n                    Please enter a unqiue group name.\n                  </small>\n                </div>\n                <button\n                  className=\"btn btn-dark\"\n                  onClick={() => {\n                    this.sumbitEditedPolygon();\n                  }}\n                >\n                  Save\n                </button>{\" \"}\n                <button\n                  className=\"btn btn-danger\"\n                  onClick={() => {\n                    this.cancelEditedPolygon();\n                  }}\n                >\n                  Cancel\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  componentDidMount() {\n    this.run();\n  }\n\n  handleShow(e) {\n    const _id = e.target.value;\n    const isSelected = e.target.checked;\n    const selectedData = this.state.tableData.rows.find(item => {\n      return _id.toString() === item._id.toString();\n    });\n    if (selectedData && selectedData.layer)\n      this.renderSelectedPolygon(selectedData, isSelected);\n  }\n\n  async handleEdit(e) {\n    // debugger;\n    const _id = e.target.value;\n    const isSelected = true;\n    const selectedData = this.state.tableData.rows.find(item => {\n      return _id.toString() === item._id.toString();\n    });\n    if (selectedData && selectedData.layer) {\n      await this.removeAllPolygonsFromMap();\n      await this.renderSelectedPolygon(selectedData, isSelected);\n      //enable controls and add poly to editable layer\n      this.enablePolygonEditControl();\n      this.editableLayers.addLayer(selectedData.layer);\n      this.setState({\n        editPolygon: true,\n        editPolygonDetails: {\n          _id: _id,\n          name: selectedData.name,\n          layer: selectedData.layer\n        }\n      });\n    }\n  }\n\n  async handleDelete(e) {\n    const confirmed = window.confirm(`Are you sure you want to delete?`);\n    if (confirmed) {\n      try {\n        const _id = e.target.value;\n        //deselect the layer\n        const isSelected = false;\n\n        const selectedData = this.state.tableData.rows.find(item => {\n          return _id.toString() === item._id.toString();\n        });\n        if (selectedData && selectedData.layer) {\n          this.renderSelectedPolygon(selectedData, isSelected);\n        }\n\n        await this.handleDelete(selectedData);\n\n        //refine the state of tabledata\n        const rows = this.state.tableData.rows.filter(item => {\n          return item._id && _id && item._id.toString() !== _id.toString();\n        });\n        this.setState({\n          tableData: {\n            ...this.state.tableData,\n            rows: rows\n          }\n        });\n      } catch (err) {\n        console.error(err);\n        alert(\"An error occurred while deleting...\");\n      }\n    }\n  }\n\n  async renderSelectedPolygon(data, isSelected) {\n    if (data.layer) {\n      const polygon = data.layer;\n      if (isSelected) {\n        await this.addPolygonAndLabelToMap(data, polygon);\n      } else {\n        await this.removePolygonAndLabelFromMap(data, polygon);\n      }\n    }\n  }\n\n  addPolygonAndLabelToMap(data, polygon) {\n    return new Promise(resolve => {\n      //add to map\n      polygon._parentId = data._id;\n      polygon.addTo(this.mapElement);\n      //add label to map\n      const label = new window.L.Label();\n      label.setContent(data.name);\n      label.setLatLng(polygon.getBounds().getCenter());\n      label._parentId = data._id;\n      polygon.bindLabel(label);\n      this.mapElement.showLabel(label);\n      //save state\n      this.setState(prevState => ({\n        currentPolygonsInView: [...prevState.currentPolygonsInView, polygon],\n        currentPolygonLabels: [...prevState.currentPolygonLabels, label]\n      }));\n      resolve();\n    });\n  }\n\n  removePolygonAndLabelFromMap(data, polygon) {\n    return new Promise(resolve => {\n      const label = this.state.currentPolygonLabels.find(item => {\n        return (\n          item._parentId &&\n          data._id &&\n          item._parentId.toString() === data._id.toString()\n        );\n      });\n\n      //remove them from the map\n      if (label) this.mapElement.removeLayer(label);\n      if (polygon) this.mapElement.removeLayer(polygon);\n\n      const currentPolygonsInView = this.state.currentPolygonsInView.filter(\n        item =>\n          item._parentId &&\n          label._parentId &&\n          item._parentId.toString() !== label._parentId.toString()\n      );\n      const currentPolygonLabels = this.state.currentPolygonLabels.filter(\n        item =>\n          item._parentId &&\n          label._parentId &&\n          item._parentId.toString() !== label._parentId.toString()\n      );\n\n      //save state\n      this.setState({\n        currentPolygonsInView: currentPolygonsInView,\n        currentPolygonLabels: currentPolygonLabels\n      });\n      resolve();\n    });\n  }\n\n  removeAllPolygonsFromMap() {\n    return new Promise((resolve, reject) => {\n      const polygonLayers = this.state.currentPolygonsInView;\n      polygonLayers.forEach(item => {\n        this.mapElement.removeLayer(item);\n      });\n      const polygonLabels = this.state.currentPolygonLabels;\n      polygonLabels.forEach(item => {\n        this.mapElement.removeLayer(item);\n      });\n\n      //save new state\n      this.setState({\n        currentPolygonsInView: [],\n        currentPolygonLabels: []\n      });\n      resolve();\n    });\n  }\n\n  async createNewPolygon() {\n    await this.removeAllPolygonsFromMap();\n    this.setState({\n      newPolygon: true\n    });\n    this.enablePolygonEditControl();\n  }\n\n  async sumbitNewPolygon() {\n    try {\n      if (\n        this.state.editPolygonDetails.name !== \"\" &&\n        this.state.editPolygonDetails.layer\n      ) {\n        //name validation\n        const existingName = this.state.tableData.rows.find(\n          item => item.name === this.state.editPolygonDetails.name\n        );\n        if (existingName) {\n          alert(`Name already exists`);\n          return;\n        }\n\n        await this.saveGroup(this.state.editPolygonDetails);\n\n        await this.addNewPolygon(this.state.editPolygonDetails);\n        this.resetForm();\n        this.disablePolygonEditControl();\n        await this.removeAllPolygonsFromMap();\n      } else {\n        alert(`Please input a valid name and shape`);\n      }\n    } catch (err) {\n      console.log(err);\n      alert(`An error occurred while editing`);\n    }\n  }\n\n  async sumbitEditedPolygon() {\n    try {\n      if (\n        this.state.editPolygonDetails.name !== \"\" &&\n        this.state.editPolygonDetails.layer\n      ) {\n        //name validation\n        const existingName = this.state.tableData.rows.find(\n          item =>\n            item.name === this.state.editPolygonDetails.name &&\n            item._id.toString() !== this.state.editPolygonDetails._id.toString()\n        );\n        if (existingName) {\n          alert(`Name already exists`);\n          return;\n        }\n\n        await this.updateGroup(this.state.editPolygonDetails);\n\n        await this.addEditedPolygon(this.state.editPolygonDetails);\n        this.resetForm();\n        this.disablePolygonEditControl();\n        await this.removeAllPolygonsFromMap();\n      } else {\n        alert(`Please input a valid name and shape`);\n      }\n    } catch (err) {\n      console.error(err);\n      alert(`An error occurred while editing`);\n    }\n  }\n\n  addNewPolygon(data) {\n    return new Promise((resolve, reject) => {\n      this.setState({\n        tableData: {\n          rows: [\n            ...this.state.tableData.rows,\n            {\n              _id: Math.random(),\n              name: data.name,\n              layer: data.layer\n            }\n          ]\n        }\n      });\n      resolve();\n    });\n  }\n\n  addEditedPolygon(data) {\n    return new Promise((resolve, reject) => {\n      const rows = this.state.tableData.rows.map(item => {\n        if (\n          this.state.editPolygonDetails._id.toString() === item._id.toString()\n        ) {\n          return Object.assign(item, {\n            name: this.state.editPolygonDetails.name,\n            layer: this.state.editPolygonDetails.layer\n          });\n        } else {\n          return item;\n        }\n      });\n\n      this.setState({\n        tableData: {\n          rows: rows\n        }\n      });\n      resolve();\n    });\n  }\n\n  cancelNewPolygon() {\n    this.resetForm();\n    this.removeAllPolygonsFromMap();\n    this.disablePolygonEditControl();\n  }\n\n  cancelEditedPolygon() {\n    this.resetForm();\n    this.removeAllPolygonsFromMap();\n    this.disablePolygonEditControl();\n  }\n\n  resetForm() {\n    this.setState({\n      newPolygon: false,\n      editPolygon: false,\n      editPolygonDetails: {\n        name: \"\",\n        layer: null\n      }\n    });\n  }\n\n  async run() {\n    await this.onLoad();\n    this.addControls();\n    const groups = await this.getGroups();\n    if (groups && groups.length) {\n      this.populateGroups(groups);\n    }\n  }\n\n  populateGroups(groups) {\n    if (groups && groups.length) {\n      const data = groups\n        .filter(item => {\n          return item.name && item.geoJSON && item._id;\n        })\n        .map(item => {\n          item.layer = window.L.GeoJSON.geometryToLayer(item.geoJSON);\n          return item;\n        });\n      this.setState({\n        tableData: {\n          ...this.state.tableData,\n          rows: data\n        }\n      });\n    }\n  }\n\n  getGroups() {\n    return new Promise((resolve, reject) => {\n      axios\n        .get(url)\n        .then(res => {\n          if (res && res.data && res.data.data) {\n            resolve(res.data.data);\n          } else {\n            reject(new Error(\"There is no data\"));\n          }\n          resolve();\n        })\n        .catch(err => {\n          reject(err);\n        });\n    });\n  }\n\n  saveGroup(polygonDetails) {\n    return new Promise((resolve, reject) => {\n      if (\n        polygonDetails &&\n        polygonDetails &&\n        polygonDetails.layer &&\n        polygonDetails.name &&\n        polygonDetails.layer.toGeoJSON() &&\n        polygonDetails.layer.toGeoJSON().geometry\n      ) {\n        let group = Object.assign({}, polygonDetails);\n        if (!group.geoJSON) {\n          group.geoJSON = group.layer.toGeoJSON().geometry;\n          delete group.layer;\n        }\n        axios\n          .post(url, group)\n          .then(res => {\n            if (res && res.data && res.data.message) {\n              resolve(res.data.message);\n            } else {\n              reject(new Error(\"There is no data\"));\n            }\n            resolve();\n          })\n          .catch(err => {\n            reject(err);\n          });\n      } else {\n        reject(new Error(`Insufficient parameters are being sent`));\n      }\n    });\n  }\n\n  updateGroup(polygonDetails) {\n    return new Promise((resolve, reject) => {\n      if (\n        polygonDetails &&\n        polygonDetails &&\n        polygonDetails.layer &&\n        polygonDetails.name &&\n        polygonDetails.layer.toGeoJSON() &&\n        polygonDetails.layer.toGeoJSON().geometry\n      ) {\n        let group = Object.assign({}, polygonDetails);\n        if (!group.geoJSON) {\n          group.geoJSON = group.layer.toGeoJSON().geometry;\n          delete group.layer;\n        }\n        axios\n          .put(url, group)\n          .then(res => {\n            if (res && res.data && res.data.message) {\n              resolve(res.data.message);\n            } else {\n              reject(new Error(\"There is no data\"));\n            }\n            resolve();\n          })\n          .catch(err => {\n            reject(err);\n          });\n      } else {\n        reject(new Error(`Insufficient parameters are being sent`));\n      }\n    });\n  }\n\n  deleteGroup(group) {\n    return new Promise((resolve, reject) => {\n      axios\n        .delete(url, { _id: group._id })\n        .then(res => {\n          if (res && res.data && res.data.message) {\n            resolve(res.data.message);\n          } else {\n            reject(new Error(\"There is no data\"));\n          }\n          resolve();\n        })\n        .catch(err => {\n          reject(err);\n        });\n    });\n  }\n\n  getLeads() {\n    return new Promise((resolve, reject) => {\n      import(\"../rawdata/leads.json\")\n        .then(data => {\n          if (data && data.default) {\n            const validatedData = data.default.filter(item => {\n              return item.lat && item.lng;\n            });\n            console.log(`render leads ${validatedData.length}`);\n            resolve(validatedData);\n          } else {\n            resolve([]);\n          }\n        })\n        .catch(err => {\n          reject(err);\n        });\n    });\n  }\n\n  getGroupToRegions() {\n    return new Promise((resolve, reject) => {\n      import(\"../rawdata/postcodeWithRegions.json\")\n        .then(data => {\n          if (data && data.default) {\n            const validatedData = data.default.filter(item => {\n              return item.lat && item.lng;\n            });\n            resolve(validatedData);\n          } else {\n            resolve([]);\n          }\n        })\n        .catch(err => {\n          reject(err);\n        });\n    });\n  }\n\n  getE5Engineers() {\n    return new Promise((resolve, reject) => {\n      import(\"../rawdata/e5Engineers.json\")\n        .then(data => {\n          if (data && data.default) {\n            const validatedData = data.default.filter(item => {\n              return item.lat && item.lng;\n            });\n            resolve(validatedData);\n          } else {\n            resolve([]);\n          }\n        })\n        .catch(err => {\n          reject(err);\n        });\n    });\n  }\n\n  getBoilerJobs() {\n    return new Promise((resolve, reject) => {\n      import(\"../rawdata/boilerJobs.json\")\n        .then(data => {\n          if (data && data.default) {\n            const validatedData = data.default.filter(item => {\n              return item.lat && item.lng;\n            });\n            resolve(validatedData);\n          } else {\n            resolve([]);\n          }\n        })\n        .catch(err => {\n          reject(err);\n        });\n    });\n  }\n\n  getServiceJobs() {\n    return new Promise((resolve, reject) => {\n      import(\"../rawdata/serviceJobs.json\")\n        .then(data => {\n          if (data && data.default) {\n            const validatedData = data.default.filter(item => {\n              return item.lat && item.lng;\n            });\n            resolve(validatedData);\n          } else {\n            resolve([]);\n          }\n        })\n        .catch(err => {\n          reject(err);\n        });\n    });\n  }\n\n  async renderE5Engineers() {\n    const type = \"e5Engineer\";\n    try {\n      const arrayContent = await this.getE5Engineers();\n      if (arrayContent && arrayContent.length) {\n        let markers = [];\n        arrayContent.forEach(item => {\n          if (item.lat && item.lng) {\n            const marker = window.L.marker([item.lat, item.lng], {\n              icon: this.markerIcon(type)\n            }).addTo(this.mapElement);\n            marker.bindPopup(this.markerPopupContent(type, item));\n            markers.push(marker);\n          }\n        });\n        this.setState({\n          [type]: markers\n        });\n      } else {\n        throw new Error(`No ${type} to be rendered`);\n      }\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  async renderE5EngineerCircles() {\n    const type = \"e5Engineer\";\n    try {\n      const arrayContent = await this.getE5Engineers();\n      if (arrayContent && arrayContent.length) {\n        let circles = [];\n        arrayContent.forEach(item => {\n          if (item.lat && item.lng) {\n            let circle = window.L.circle([item.lat, item.lng], 40233.6).addTo(\n              this.mapElement\n            );\n            circles.push(circle);\n          }\n        });\n        this.setState({\n          [`${type}Circle`]: circles\n        });\n      } else {\n        throw new Error(`No ${type} to be rendered`);\n      }\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  async renderBoilerJobs() {\n    const type = \"boilerJob\";\n    try {\n      const arrayContent = await this.getBoilerJobs();\n      if (arrayContent && arrayContent.length) {\n        let markerLayer = window.L.markerClusterGroup();\n        let markers = [];\n        arrayContent.forEach(item => {\n          if (item.lat && item.lng) {\n            const marker = window.L.marker([item.lat, item.lng], {\n              icon: this.markerIcon(type)\n            });\n            marker.bindPopup(this.markerPopupContent(type, item));\n            markerLayer.addLayer(marker);\n            markers.push(marker);\n          }\n        });\n        markerLayer.addTo(this.mapElement);\n        this.setState({\n          [`${type}Cluster`]: markerLayer,\n          [type]: markers\n        });\n      } else {\n        throw new Error(`No ${type} to be rendered`);\n      }\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  async renderServiceJobs() {\n    const type = \"serviceJob\";\n    try {\n      const arrayContent = await this.getServiceJobs();\n      if (arrayContent && arrayContent.length) {\n        let markerLayer = window.L.markerClusterGroup();\n        let markers = [];\n        arrayContent.forEach(item => {\n          if (item.lat && item.lng) {\n            const marker = window.L.marker([item.lat, item.lng], {\n              icon: this.markerIcon(type)\n            });\n            marker.bindPopup(this.markerPopupContent(type, item));\n            markerLayer.addLayer(marker);\n            markers.push(marker);\n          }\n        });\n        markerLayer.addTo(this.mapElement);\n        this.setState({\n          [`${type}Cluster`]: markerLayer,\n          [type]: markers\n        });\n      } else {\n        throw new Error(`No ${type} to be rendered`);\n      }\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  async renderLeads() {\n    const type = \"lead\";\n    try {\n      const arrayContent = await this.getLeads();\n      if (arrayContent && arrayContent.length) {\n        let markerLayer = window.L.markerClusterGroup();\n        let markers = [];\n        arrayContent.forEach(item => {\n          if (item.lat && item.lng) {\n            const marker = window.L.marker([item.lat, item.lng], {\n              icon: this.markerIcon(type)\n            });\n            marker.bindPopup(this.markerPopupContent(type, item));\n            markerLayer.addLayer(marker);\n            markers.push(marker);\n          }\n        });\n        markerLayer.addTo(this.mapElement);\n        this.setState({\n          [`${type}Cluster`]: markerLayer,\n          [type]: markers\n        });\n      } else {\n        throw new Error(`No ${type} to be rendered`);\n      }\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  async renderServiceJobsHeatMap() {\n    const type = \"serviceJob\";\n    const arrayContent = await this.getServiceJobs();\n    const addressPoints = arrayContent.map(function(p) {\n      return [p.lat, p.lng, 0.5];\n    });\n    const heat = window.L.heatLayer(addressPoints, {\n      radius: 10,\n      minOpacity: 1\n    }).addTo(this.mapElement);\n    this.setState({\n      [`${type}sHeatMap`]: heat\n    });\n    try {\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  async renderLeadsHeatMap() {\n    const type = \"lead\";\n    const arrayContent = await this.getLeads();\n    const addressPoints = arrayContent.map(function(p) {\n      return [p.lat, p.lng, 0.5];\n    });\n    const heat = window.L.heatLayer(addressPoints, {\n      radius: 10,\n      minOpacity: 1\n    }).addTo(this.mapElement);\n    this.setState({\n      [`${type}sHeatMap`]: heat\n    });\n    try {\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  async renderBoilerJobsHeatMap() {\n    const type = \"boilerJob\";\n    const arrayContent = await this.getBoilerJobs();\n    const addressPoints = arrayContent.map(function(p) {\n      return [p.lat, p.lng, 0.5];\n    });\n    const heat = window.L.heatLayer(addressPoints, {\n      radius: 10,\n      minOpacity: 1\n    }).addTo(this.mapElement);\n    this.setState({\n      [`${type}sHeatMap`]: heat\n    });\n    try {\n    } catch (err) {\n      console.error(err);\n      alert(`Error while rendering ${type}`);\n    }\n  }\n\n  markerPopupContent(type, item) {\n    let content = \"\";\n    let tableContent = \"\";\n    Object.keys(item).forEach(k => {\n      tableContent =\n        tableContent +\n        `\n      <tr>\n      <td class=\"popup-table-row\">\n      <td>${k}</td>\n      <td>${item[k]}</td>\n      </td>\n        </tr>\n        `;\n    });\n    if (tableContent) {\n      content = `\n      <table class=\"table table-dark\">\n      ${tableContent}\n      </table>\n      `;\n    }\n    return content;\n  }\n\n  markerIcon(type) {\n    //   \"https://res.cloudinary.com/razrlab/image/upload/c_scale,co_rgb:D12711,e_colorize:100,f_png/v1541359481/pin_t5dc4n.png\",\n    let icon = \"\";\n    switch (type) {\n      case \"e5Engineer\":\n        icon =\n          \"https://res.cloudinary.com/razrlab/image/upload/v1571935748/person-marker_wdvvbm.png\";\n        break;\n      case \"serviceJob\":\n        icon =\n          \"https://res.cloudinary.com/razrlab/image/upload/v1571935748/service-marker_tzrx0s.png\";\n        break;\n      case \"lead\":\n      case \"boilerJob\":\n        icon =\n          \"https://res.cloudinary.com/razrlab/image/upload/v1571935748/home-marker_sskts6.png\";\n        break;\n      default:\n        //nothing\n        break;\n    }\n    const iconElement = window.L.icon({\n      iconUrl: icon,\n      iconSize: [25, 25],\n      iconAnchor: [12, 25],\n      popupAnchor: [3, -40]\n    });\n\n    return iconElement;\n  }\n\n  removeMarkers() {\n    return new Promise((resolve, reject) => {\n      this.removeE5Engineers();\n      resolve();\n    });\n  }\n\n  removeE5EngineerCircles() {\n    let circles = this.state.e5EngineerCircle;\n    if (circles && circles.length) {\n      circles.forEach(item => {\n        this.mapElement.removeLayer(item);\n      });\n    }\n  }\n\n  removeE5Engineers() {\n    let e5EngineerMarkers = this.state.e5Engineer;\n    if (e5EngineerMarkers && e5EngineerMarkers.length) {\n      e5EngineerMarkers.forEach(item => {\n        this.mapElement.removeLayer(item);\n      });\n    }\n  }\n\n  removeServiceJobs() {\n    let markers = this.state.serviceJob;\n    let clusters = this.state.serviceJobCluster;\n    if (markers && markers.length) {\n      markers.forEach(item => {\n        this.mapElement.removeLayer(item);\n      });\n      clusters && this.mapElement.removeLayer(clusters);\n    }\n  }\n\n  removeLeads() {\n    let markers = this.state.lead;\n    let clusters = this.state.leadCluster;\n    if (markers && markers.length) {\n      markers.forEach(item => {\n        this.mapElement.removeLayer(item);\n      });\n      clusters && this.mapElement.removeLayer(clusters);\n    }\n  }\n\n  removeBoilerJobs() {\n    let markers = this.state.boilerJob;\n    let clusters = this.state.boilerJobCluster;\n    if (markers && markers.length) {\n      markers.forEach(item => {\n        this.mapElement.removeLayer(item);\n      });\n      clusters && this.mapElement.removeLayer(clusters);\n    }\n  }\n\n  removeServiceJobsHeatMap() {\n    const layer = this.state.serviceJobsHeatMap;\n    layer && this.mapElement.removeLayer(layer);\n  }\n\n  removeLeadsHeatMap() {\n    const layer = this.state.leadsHeatMap;\n    layer && this.mapElement.removeLayer(layer);\n  }\n\n  removeBoilerJobsHeatMap() {\n    const layer = this.state.boilerJobsHeatMap;\n    layer && this.mapElement.removeLayer(layer);\n  }\n  addControls() {\n    const L = window.L;\n    L.control\n      .custom({\n        position: \"bottomleft\",\n        content: `\n        <div class=\"panel-body\">\n          <div class=\"checkbox\">\n            <label><input type=\"checkbox\" value=\"e5Engineers\">E5 Engineers</label>\n          </div>\n          <div class=\"checkbox\">\n            <label><input type=\"checkbox\" value=\"e5EngineerCircles\">E5 Engineers Boundaries</label>\n          </div>\n          <div class=\"checkbox\">\n          <label><input type=\"checkbox\" value=\"leadsHeatMap\">Leads Heat Map</label>\n          </div>\n          <div class=\"checkbox\">\n          <label><input type=\"checkbox\" value=\"serviceJobsHeatMap\">Service Jobs Heat Map</label>\n          </div>\n          <div class=\"checkbox\">\n          <label><input type=\"checkbox\" value=\"boilerJobsHeatMap\">Boiler Jobs Heat Map</label>\n          </div>\n          <div class=\"checkbox\">\n            <label><input type=\"checkbox\" value=\"leads\">Leads</label>\n          </div>\n          <div class=\"checkbox\">\n            <label><input type=\"checkbox\" value=\"serviceJobs\">Service Jobs</label>\n          </div>\n          <div class=\"checkbox\">\n            <label><input type=\"checkbox\" value=\"boilerJobs\">Boiler Jobs</label>\n          </div>\n          <hr />\n          <div class=\"checkbox\">\n            <label><input type=\"checkbox\" value=\"geofenceControls\">Polygon Controls</label>\n          </div>  \n        </div>\n        `,\n        classes: \"panel panel-default\",\n        style: {},\n        events: {\n          click: data => {\n            if (data && data.srcElement && data.srcElement.type) {\n              switch (data.srcElement.value) {\n                case \"leads\":\n                  data.srcElement.checked\n                    ? this.renderLeads()\n                    : this.removeLeads();\n                  break;\n                case \"leadsHeatMap\":\n                  data.srcElement.checked\n                    ? this.renderLeadsHeatMap()\n                    : this.removeLeadsHeatMap();\n                  break;\n                case \"e5Engineers\":\n                  data.srcElement.checked\n                    ? this.renderE5Engineers()\n                    : this.removeE5Engineers();\n                  break;\n                case \"e5EngineerCircles\":\n                  data.srcElement.checked\n                    ? this.renderE5EngineerCircles()\n                    : this.removeE5EngineerCircles();\n                  break;\n                case \"serviceJobs\":\n                  data.srcElement.checked\n                    ? this.renderServiceJobs()\n                    : this.removeServiceJobs();\n                  break;\n                case \"serviceJobsHeatMap\":\n                  data.srcElement.checked\n                    ? this.renderServiceJobsHeatMap()\n                    : this.removeServiceJobsHeatMap();\n                  break;\n                case \"boilerJobs\":\n                  data.srcElement.checked\n                    ? this.renderBoilerJobs()\n                    : this.removeBoilerJobs();\n                  break;\n                case \"boilerJobsHeatMap\":\n                  data.srcElement.checked\n                    ? this.renderBoilerJobsHeatMap()\n                    : this.removeBoilerJobsHeatMap();\n                  break;\n                case \"geofenceControls\":\n                  data.srcElement.checked\n                    ? this.showSideBar()\n                    : this.hideSideBar();\n                  break;\n                default:\n                  break;\n              }\n            }\n          }\n        }\n      })\n      .addTo(this.mapElement);\n  }\n\n  initEditableLayer() {\n    this.editableLayers = new window.L.FeatureGroup();\n    this.mapElement.addLayer(this.editableLayers);\n  }\n\n  initDrawControls() {\n    let drawPluginOptions = {\n      position: \"topright\",\n      draw: {\n        polygon: {\n          allowIntersection: false, // Restricts shapes to simple polygons\n          drawError: {\n            color: \"#e1e100\", // Color the shape will turn when intersects\n            message: \"<strong>Oh snap!<strong> you can't draw that!\" // Message that will show when intersect\n          },\n          shapeOptions: {\n            color: \"#97009c\"\n          }\n        },\n        // disable toolbar item by setting it to false\n        polyline: false,\n        circle: false, // Turns off this drawing tool\n        rectangle: false,\n        marker: false\n      },\n      edit: {\n        featureGroup: this.editableLayers, //REQUIRED!!\n        remove: false\n      }\n    };\n    this.drawControl = new window.L.Control.Draw(drawPluginOptions);\n  }\n\n  enablePolygonEditControl() {\n    const map = this.mapElement;\n\n    map.on(\"draw:created\", e => {\n      console.log(\"draw:created\");\n      const layer = e.layer;\n\n      this.setState({\n        editPolygonDetails: {\n          ...this.state.editPolygonDetails,\n          layer: layer\n        },\n        currentPolygonsInView: [layer]\n      });\n\n      this.editableLayers.addLayer(layer);\n    });\n\n    map.on(\"draw:edited\", e => {\n      console.log(\"draw:edited\");\n      const layers = e.layers;\n      layers.eachLayer(layer => {\n        this.setState({\n          editPolygonDetails: {\n            ...this.state.editPolygonDetails,\n            layer: layer\n          },\n          currentPolygonsInView: [layer]\n        });\n      });\n    });\n\n    map.addControl(this.drawControl);\n  }\n\n  disablePolygonEditControl() {\n    if (this.drawControl) {\n      this.mapElement.removeControl(this.drawControl);\n    }\n  }\n\n  onLoad() {\n    return new Promise((resolve, reject) => {\n      const L = window.L;\n      const $ = window.$;\n      const config = window.config;\n      const loading = L.control({ position: \"bottomright\" }),\n        loaded = {\n          areas: false,\n          districts: false,\n          sectors: false\n        },\n        geoJsonLayerOptions = {\n          style: config.shapeStyle,\n          onEachFeature: onEachFeature\n        },\n        layerAreas = L.geoJson(null, geoJsonLayerOptions),\n        layerDistricts = L.geoJson(null, geoJsonLayerOptions),\n        layerSectors = L.geoJson(null, geoJsonLayerOptions),\n        layerGoogle = L.tileLayer(\n          \"http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}?key=AIzaSyC0AJcO-U5RksjP02AQHxEuFlEW5xSKzp8\",\n          {\n            maxZoom: 20,\n            subdomains: [\"mt0\", \"mt1\", \"mt2\", \"mt3\"]\n          }\n        ),\n        layerOSM = L.tileLayer(config.openStreetMap.url, {\n          // OpenStreetMap tile layer (default)\n          attribution: config.openStreetMap.attribution,\n          maxZoom: config.zoom.max\n        }),\n        tileMaps = {\n          // Tile map layer switcher\n          \"Google Maps\": layerGoogle,\n          RAZRMAPS: layerOSM\n        },\n        overlayMaps = {\n          // GeoJSON layer switcher\n          Areas: layerAreas,\n          Districts: layerDistricts,\n          Sectors: layerSectors\n        },\n        map = L.map(\"map\", {\n          // Setup map object\n          center: [53.21919, -1.86768],\n          zoom: 7,\n          layers: [layerOSM]\n        });\n\n      const sidebar = L.control.sidebar(\"sidebar\", {\n        closeButton: true,\n        position: \"left\"\n      });\n      map.addControl(sidebar);\n\n      //expose some elements\n      this.sidebarElement = sidebar;\n      this.mapElement = map;\n\n      // Add layers control\n      L.control.layers(tileMaps, overlayMaps, { collapsed: false }).addTo(map);\n\n      this.initEditableLayer();\n      this.initDrawControls();\n\n      // For each feature, set random fill colour and bind 'name' label\n      function onEachFeature(feature, layer) {\n        layer.setStyle({ fillColor: randomColor() });\n        layer.bindLabel(feature.properties.name, { noHide: true });\n      }\n\n      function randomRange(min, max) {\n        return Math.floor(Math.random() * (max - min)) + min;\n      }\n\n      function randomColor() {\n        return (\n          \"rgb(\" +\n          randomRange(0, 256) +\n          \",\" +\n          randomRange(0, 256) +\n          \",\" +\n          randomRange(0, 256) +\n          \")\"\n        );\n      }\n\n      // Setup GeoJSON loading indicator and add to map\n      loading.onAdd = function() {\n        const div = L.DomUtil.create(\"div\", \"control loader\");\n\n        div.innerHTML = `\n              <div>\\\n                  Areas... <span id=\"loadAreas\">&#x21BB;</span><br>\n                  Districts... <span id=\"loadDistricts\">&#x21BB;</span><br>\n                  Sectors... <span id=\"loadSectors\">&#x21BB;</span>\n              </div>\n              `;\n\n        return div;\n      };\n      loading.addTo(map);\n\n      // Automatically set the GeoJSON layer depending on zoom level\n      // map.on(\"zoomend\", function() {\n      //   if (!(loaded.areas && loaded.districts && loaded.sectors)) {\n      //     return;\n      //   }\n\n      //   const zoom = map.getZoom();\n\n      //   if (\n      //     zoom >= config.zoom.areas &&\n      //     zoom < config.zoom.districts &&\n      //     !map.hasLayer(layerAreas)\n      //   ) {\n      //     map.removeLayer(layerDistricts);\n      //     map.removeLayer(layerSectors);\n      //     map.addLayer(layerAreas);\n      //   } else if (\n      //     zoom >= config.zoom.districts &&\n      //     zoom < config.zoom.sectors &&\n      //     !map.hasLayer(layerDistricts)\n      //   ) {\n      //     map.removeLayer(layerAreas);\n      //     map.removeLayer(layerSectors);\n      //     map.addLayer(layerDistricts);\n      //   } else if (zoom >= config.zoom.sectors && !map.hasLayer(layerSectors)) {\n      //     map.removeLayer(layerAreas);\n      //     map.removeLayer(layerDistricts);\n      //     map.addLayer(layerSectors);\n      //   }\n      // });\n\n      // Load postcode Areas GeoJSON file\n      $.getJSON(config.files.areas, function(data) {\n        // Add loaded GeoJSON data to layer\n        layerAreas.addData(data.features);\n\n        // Show Areas layer by default\n        map.addLayer(layerAreas);\n\n        loaded.areas = true;\n        $(\"#loadAreas\").html(\"&#x2713;\");\n      }).error(function(error) {\n        console.error(\n          \"Failed loading '\" + config.files.areas + \"'\",\n          \"Error: \" + error.statusText\n        );\n\n        $(\"#loadAreas\").html(\"&#x2717;\");\n      });\n\n      // Load postcode Districts GeoJSON file\n      $.getJSON(config.files.districts, function(data) {\n        // Add loaded GeoJSON data to layer\n        layerDistricts.addData(data.features);\n\n        loaded.districts = true;\n        $(\"#loadDistricts\").html(\"&#x2713;\");\n      }).error(function(error) {\n        console.error(\n          \"Failed loading '\" + config.files.districts + \"'\",\n          \"Error: \" + error.statusText\n        );\n\n        $(\"#loadDistricts\").html(\"&#x2717;\");\n      });\n\n      // Load postcode Sectors GeoJSON file\n      $.getJSON(config.files.sectors, function(data) {\n        // Add loaded GeoJSON data to layer\n        layerSectors.addData(data.features);\n\n        loaded.sectors = true;\n        $(\"#loadSectors\").html(\"&#x2713;\");\n      }).error(function(error) {\n        console.error(\n          \"Failed loading '\" + config.files.sectors + \"'\",\n          \"Error: \" + error.statusText\n        );\n\n        $(\"#loadSectors\").html(\"&#x2717;\");\n      });\n      resolve();\n    });\n  }\n\n  showSideBar() {\n    this.sidebarElement.show();\n  }\n\n  hideSideBar() {\n    this.sidebarElement.hide();\n  }\n}\n\nexport { Map };\n","export function authHeader() {\n    // return authorization header with basic auth credentials\n    let user = JSON.parse(localStorage.getItem('user'));\n\n    if (user && user.authdata) {\n        return { 'Authorization': 'Basic ' + user.authdata };\n    } else {\n        return {};\n    }\n}","import { authHeader } from '../_helpers';\n\nexport const userService = {\n    login,\n    logout,\n    getAll\n};\n\nfunction login(username, password) {\n    const requestOptions = {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username, password })\n    };\n\n    return fetch(`/users/authenticate`, requestOptions)\n        .then(handleResponse)\n        .then(user => {\n            // login successful if there's a user in the response\n            if (user) {\n                // store user details and basic auth credentials in local storage \n                // to keep user logged in between page refreshes\n                user.authdata = window.btoa(username + ':' + password);\n                localStorage.setItem('user', JSON.stringify(user));\n            }\n\n            return user;\n        });\n}\n\nfunction logout() {\n    // remove user from local storage to log user out\n    localStorage.removeItem('user');\n}\n\nfunction getAll() {\n    const requestOptions = {\n        method: 'GET',\n        headers: authHeader()\n    };\n\n    return fetch(`/users`, requestOptions).then(handleResponse);\n}\n\nfunction handleResponse(response) {\n    return response.text().then(text => {\n        const data = text && JSON.parse(text);\n        if (!response.ok) {\n            if (response.status === 401) {\n                // auto logout if 401 response returned from api\n                logout();\n                window.location.reload(true);\n            }\n\n            const error = (data && data.message) || response.statusText;\n            return Promise.reject(error);\n        }\n\n        return data;\n    });\n}","import React from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport { userService } from \"../_services\";\n\nimport { Map } from \"../_components\";\n\nclass HomePage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      user: {},\n      users: []\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      user: JSON.parse(localStorage.getItem(\"user\")),\n      users: { loading: true }\n    });\n    userService.getAll().then(users => this.setState({ users }));\n  }\n\n  render() {\n    const { user, users } = this.state;\n    return <Map />;\n  }\n}\n\nexport { HomePage };\n","import React from \"react\";\n\nimport { userService } from \"../_services\";\n\nimport \"./LoginPage.css\";\n\nclass LoginPage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    userService.logout();\n\n    this.state = {\n      username: \"\",\n      password: \"\",\n      submitted: false,\n      loading: false,\n      error: \"\"\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  handleChange(e) {\n    const { name, value } = e.target;\n    this.setState({ [name]: value });\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n\n    this.setState({ submitted: true });\n    const { username, password, returnUrl } = this.state;\n\n    // stop here if form is invalid\n    if (!(username && password)) {\n      return;\n    }\n\n    this.setState({ loading: true });\n    userService.login(username, password).then(\n      user => {\n        const { from } = this.props.location.state || {\n          from: { pathname: \"/\" }\n        };\n        this.props.history.push(from);\n      },\n      error => this.setState({ error, loading: false })\n    );\n  }\n\n  render() {\n    const { username, password, submitted, loading, error } = this.state;\n\n    // return (\n    //   <div className=\"login-page\">\n    //     <div className=\"form\">\n    //       <form className=\"register-form\" onSubmit={this.handleSubmit}>\n    //         <input\n    //           type=\"text\"\n    //           className=\"form-control\"\n    //           name=\"username\"\n    //           value={username}\n    //           onChange={this.handleChange}\n    //         />\n    //         <input\n    //           type=\"password\"\n    //           className=\"form-control\"\n    //           name=\"password\"\n    //           value={password}\n    //           onChange={this.handleChange}\n    //         />\n    //       </form>\n    //       <form className=\"login-form\">\n    //         <input type=\"text\" placeholder=\"username\" />\n    //         <input type=\"password\" placeholder=\"password\" />\n    //         <div className=\"form-group\">\n    //           <button className=\"btn btn-primary\" disabled={loading}>\n    //             Login\n    //           </button>\n    //           {loading && (\n    //             <img src=\"data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==\" />\n    //           )}\n    //         </div>\n    //         {error && <div className={\"alert alert-danger\"}>{error}</div>}\n    //         <p className=\"message\">\n    //           This is a private page. If you're not supposed to be here, walk\n    //           away now!\n    //         </p>\n    //       </form>\n    //     </div>\n    //   </div>\n    // );\n\n    return (\n      <div className=\"login-page\">\n        <div className=\"form\">\n          <h2>Map Analyzer</h2>\n          <form name=\"form\" onSubmit={this.handleSubmit}>\n            <div\n              className={\n                \"form-group\" + (submitted && !username ? \" has-error\" : \"\")\n              }\n            >\n              <input\n                type=\"text\"\n                className=\"form-control\"\n                name=\"username\"\n                value={username}\n                onChange={this.handleChange}\n                placeholder=\"Username\"\n              />\n              {submitted && !username && (\n                <div className=\"help-block\">Username is required</div>\n              )}\n            </div>\n            <div\n              className={\n                \"form-group\" + (submitted && !password ? \" has-error\" : \"\")\n              }\n            >\n              <input\n                type=\"password\"\n                className=\"form-control\"\n                name=\"password\"\n                value={password}\n                onChange={this.handleChange}\n                placeholder=\"Password\"\n              />\n              {submitted && !password && (\n                <div className=\"help-block\">Password is required</div>\n              )}\n            </div>\n            <div className=\"form-group\">\n              <button className=\"btn btn-primary\" disabled={loading}>\n                Login\n              </button>\n              {loading && (\n                <img src=\"data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==\" />\n              )}\n            </div>\n            {error && <div className={\"alert alert-danger\"}>{error}</div>}\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport { LoginPage };\n","import React from \"react\";\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\n\nimport { PrivateRoute } from \"../_components\";\nimport { HomePage } from \"../HomePage\";\nimport { LoginPage } from \"../LoginPage\";\n\nclass App extends React.Component {\n  render() {\n    return (\n      // <div className=\"jumbotron\">\n      //     <div className=\"container\">\n      //         <div className=\"col-sm-8 col-sm-offset-2\">\n      <Router>\n        <div>\n          <PrivateRoute exact path=\"/\" component={HomePage} />\n          <Route path=\"/login\" component={LoginPage} />\n        </div>\n      </Router>\n      //         </div>\n      //     </div>\n      // </div>\n    );\n  }\n}\n\nexport { App };\n","export function configureFakeBackend() {\n    let users = [{ id: 1, username: 'vp', password: 'vptester', firstName: 'Test', lastName: 'User' }];\n    let realFetch = window.fetch;\n    window.fetch = function (url, opts) {\n        return new Promise((resolve, reject) => {\n            // wrap in timeout to simulate server api call\n            setTimeout(() => {\n\n                // authenticate\n                if (url.endsWith('/users/authenticate') && opts.method === 'POST') {\n                    // get parameters from post request\n                    let params = JSON.parse(opts.body);\n\n                    // find if any user matches login credentials\n                    let filteredUsers = users.filter(user => {\n                        return user.username === params.username && user.password === params.password;\n                    });\n\n                    if (filteredUsers.length) {\n                        // if login details are valid return user details\n                        let user = filteredUsers[0];\n                        let responseJson = {\n                            id: user.id,\n                            username: user.username,\n                            firstName: user.firstName,\n                            lastName: user.lastName\n                        };\n                        resolve({ ok: true, text: () => Promise.resolve(JSON.stringify(responseJson)) });\n                    } else {\n                        // else return error\n                        reject('Username or password is incorrect');\n                    }\n\n                    return;\n                }\n\n                // get users\n                if (url.endsWith('/users') && opts.method === 'GET') {\n                    // check for fake auth token in header and return users if valid, this security \n                    // is implemented server side in a real application\n                    if (opts.headers && opts.headers.Authorization === `Basic ${window.btoa('vp:vptester')}`) {\n                        resolve({ ok: true, text: () => Promise.resolve(JSON.stringify(users)) });\n                    } else {\n                        // return 401 not authorised if token is null or invalid\n                        resolve({ status: 401, text: () => Promise.resolve() });\n                    }\n\n                    return;\n                }\n\n                // pass through any requests not handled above\n                realFetch(url, opts).then(response => resolve(response));\n\n            }, 500);\n        });\n    }\n}","import React from \"react\";\nimport { render } from \"react-dom\";\n\nimport { App } from \"./App\";\n\n// setup fake backend\nimport { configureFakeBackend } from \"./_helpers\";\nconfigureFakeBackend();\nrender(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}